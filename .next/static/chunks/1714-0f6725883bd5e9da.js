"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1714,6660],{1714:(e,t,a)=>{a.d(t,{Wp:()=>m,Jf:()=>y,j$:()=>s,gW:()=>o,sZ:()=>c,le:()=>u});let r={all:["staff"],lists:()=>[...r.all,"list"],list:e=>[...r.lists(),{filter:e}],details:()=>[...r.all,"detail"],detail:e=>[...r.details(),e],active:()=>[...r.all,"active"],projectManagers:()=>[...r.all,"projectManagers"],summary:()=>[...r.all,"summary"],projectAssignments:e=>[...r.all,"assignments",e]};var n=a(67914),i=a(66660);function o(e){return(0,n.I)({queryKey:r.list(e),queryFn:()=>i.staffService.getAll(e),staleTime:3e5})}function s(){return(0,n.I)({queryKey:r.projectManagers(),queryFn:()=>i.staffService.getProjectManagers(),staleTime:6e5})}function c(e,t){return(0,n.I)({queryKey:r.detail(e),queryFn:()=>i.staffService.getById(e),enabled:(null==t?void 0:t.enabled)!==!1&&!!e})}var l=a(67768),d=a(40097),p=a(16932);function m(){let e=(0,l.jE)();return(0,d.n)({mutationFn:e=>i.staffService.create(e),onSuccess:()=>{e.invalidateQueries({queryKey:r.all})},onError:e=>{throw p.Rm.error("Failed to create staff member:",{data:e},"mutations"),e}})}function u(){let e=(0,l.jE)();return(0,d.n)({mutationFn:e=>{let{id:t,data:a}=e;return i.staffService.update(t,a)},onSuccess:(t,a)=>{let{id:n}=a;e.invalidateQueries({queryKey:r.detail(n)}),e.invalidateQueries({queryKey:r.lists()}),e.invalidateQueries({queryKey:r.active()}),e.invalidateQueries({queryKey:r.projectManagers()}),e.invalidateQueries({queryKey:r.summary()})},onError:e=>{throw p.Rm.error("Failed to update staff member:",{data:e},"mutations"),e}})}function y(){let e=(0,l.jE)();return(0,d.n)({mutationFn:e=>i.staffService.delete(e),onSuccess:(t,a)=>{e.removeQueries({queryKey:r.detail(a)}),e.invalidateQueries({queryKey:r.lists()}),e.invalidateQueries({queryKey:r.active()}),e.invalidateQueries({queryKey:r.projectManagers()}),e.invalidateQueries({queryKey:r.summary()})},onError:e=>{throw p.Rm.error("Failed to delete staff member:",{data:e},"mutations"),e}})}a(14232)},66660:(e,t,a)=>{a.d(t,{staffService:()=>u});var r=a(60225);let n="/api";async function i(e){if(!e.ok)throw Error((await e.json().catch(()=>({message:"Request failed"}))).message||"HTTP ".concat(e.status));let t=await e.json();return t.data||t}function o(e){return{id:e.id,employeeId:e.employee_id,name:e.name,email:e.email,phone:e.phone,alternatePhone:e.alternate_phone,address:e.address,city:e.city,state:e.state,postalCode:e.postal_code,department:e.department,position:e.position,type:e.type,status:e.status,salary:e.salary,joinDate:e.join_date,startDate:e.join_date,endDate:e.end_date,emergencyContact:e.emergency_contact,skills:e.skills,certifications:e.certifications,notes:e.notes,reportsTo:e.reports_to,currentProjectCount:e.project_count||0,maxProjectCount:5,managerName:e.manager_name,createdAt:e.created_at,updatedAt:e.updated_at}}function s(e){return{id:e.id,employee_id:e.employeeId,name:e.name,email:e.email,phone:e.phone,alternate_phone:e.alternatePhone,address:e.address,city:e.city,state:e.state,postal_code:e.postalCode,department:e.department,position:e.position,type:e.type,status:e.status,salary:e.salary,join_date:e.joinDate||e.startDate,end_date:e.endDate,emergency_contact:e.emergencyContact,skills:e.skills,certifications:e.certifications,notes:e.notes,reports_to:e.reportsTo}}var c=a(29143),l=a(12770),d=a(6318);let p={async exportToExcel(e){let t=(e||await r.staffNeonService.getAll()).map(e=>({"Employee ID":e.employeeId,Name:e.name,Email:e.email,Phone:e.phone,"Alternative Phone":e.alternativePhone||"",Position:e.position,Department:e.department,Level:e.level,Status:e.status,Manager:e.managerName||"",Skills:e.skills.join(", "),"Experience Years":e.experienceYears,Address:e.address,City:e.city,Province:e.province,"Postal Code":e.postalCode,"Emergency Contact Name":e.emergencyContactName||"","Emergency Contact Phone":e.emergencyContactPhone||"","Start Date":e.startDate?(0,d.xi)(e.startDate).toLocaleDateString("en-GB"):"","Contract Type":e.contractType,"Working Hours":e.workingHours,"Available Weekends":e.availableWeekends?"Yes":"No","Available Nights":e.availableNights?"Yes":"No","Current Projects":e.currentProjectCount,"Max Projects":e.maxProjectCount,"Projects Completed":e.totalProjectsCompleted,"Average Rating":e.averageProjectRating,"On-Time Completion Rate":"".concat(e.onTimeCompletionRate,"%")})),a=l.Wp.json_to_sheet(t),n=l.Wp.book_new();return l.Wp.book_append_sheet(n,a,"Staff"),a["!cols"]=[{wch:15},{wch:25},{wch:30},{wch:15},{wch:15},{wch:20},{wch:15},{wch:12},{wch:10},{wch:25},{wch:40},{wch:10},{wch:30},{wch:15},{wch:12},{wch:10},{wch:25},{wch:15},{wch:12},{wch:12},{wch:15},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:15}],new Blob([l.M9(n,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})},getImportTemplate(){let e=l.Wp.json_to_sheet([{name:"John Doe",email:"john.doe@example.com",phone:"0821234567",alternativePhone:"0119876543",employeeId:"EMP001",position:"Senior Technician",department:"engineering",level:"senior",status:"active",skills:"fiber_splicing,otdr_testing,troubleshooting",address:"123 Main Street",city:"Johannesburg",province:"Gauteng",postalCode:"2000",emergencyContactName:"Jane Doe",emergencyContactPhone:"0829876543",startDate:"01/01/2023",endDate:"",contractType:"permanent",workingHours:"08:00 - 17:00"}]),t=l.Wp.book_new();l.Wp.book_append_sheet(t,e,"Staff Import Template");let a=l.Wp.json_to_sheet([{Field:"name",Required:"Yes",Description:"Full name of the staff member"},{Field:"email",Required:"Yes",Description:"Email address (must be unique)"},{Field:"phone",Required:"Yes",Description:"Primary phone number"},{Field:"alternativePhone",Required:"No",Description:"Alternative contact number"},{Field:"employeeId",Required:"No",Description:"Employee ID (auto-generated if empty)"},{Field:"position",Required:"No",Description:"Job title or position"},{Field:"department",Required:"No",Description:"Department: management, engineering, installation, maintenance, sales, operations, etc."},{Field:"level",Required:"No",Description:"Level: intern, junior, intermediate, senior, lead, manager, etc."},{Field:"status",Required:"No",Description:"Status: active, inactive, on_leave, suspended, terminated"},{Field:"skills",Required:"No",Description:"Comma-separated skills: fiber_splicing, otdr_testing, cable_installation, etc."},{Field:"address",Required:"No",Description:"Street address"},{Field:"city",Required:"No",Description:"City"},{Field:"province",Required:"No",Description:"Province"},{Field:"postalCode",Required:"No",Description:"Postal code"},{Field:"emergencyContactName",Required:"No",Description:"Emergency contact person name"},{Field:"emergencyContactPhone",Required:"No",Description:"Emergency contact phone number"},{Field:"startDate",Required:"No",Description:"Employment start date (DD/MM/YYYY)"},{Field:"endDate",Required:"No",Description:"Employment end date (DD/MM/YYYY) - leave empty for active employees"},{Field:"contractType",Required:"No",Description:"Contract type: permanent, contract, temporary, freelance, intern"},{Field:"workingHours",Required:"No",Description:"Working hours (e.g., 08:00 - 17:00)"}]);return l.Wp.book_append_sheet(t,a,"Instructions"),new Blob([l.M9(t,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}},m={async getAll(e){let t=new URLSearchParams;e&&((e.search||e.searchTerm)&&t.append("search",e.search||e.searchTerm),e.department&&t.append("department",e.department),e.status&&t.append("status",e.status),e.position&&t.append("position",e.position));let a=t.toString()?"?".concat(t.toString()):"",r=await fetch("".concat(n,"/staff").concat(a));return(await i(r)).map(o)},async getById(e){let t=await fetch("".concat(n,"/staff?id=").concat(e)),a=await i(t);return a?o(a):null},async create(e){let t=s(e),a=await fetch("".concat(n,"/staff"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return o(await i(a))},async update(e,t){let a=s(t),r=await fetch("".concat(n,"/staff?id=").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return o(await i(r))},delete:async e=>i(await fetch("".concat(n,"/staff?id=").concat(e),{method:"DELETE"})),async getActiveStaff(){return(await this.getAll()).filter(e=>"active"===e.status)},async getStaffByDepartment(e){return(await this.getAll()).filter(t=>t.department===e)},async getStaffSummary(){let e=await this.getAll(),t=[...new Set(e.map(e=>e.department).filter(Boolean))],a=e.filter(e=>"active"===e.status&&e.salary).map(e=>e.salary||0);return{totalStaff:e.length,activeStaff:e.filter(e=>"active"===e.status).length,departments:t,averageSalary:a.length>0?a.reduce((e,t)=>e+t,0)/a.length:0}}},u={getAll:m.getAll,getById:m.getById,create:m.create,createOrUpdate:m.create,update:m.update,delete:m.delete,getActiveStaff:m.getActiveStaff,getProjectManagers:()=>m.getAll().then(e=>e.filter(e=>"active"===e.status)),getStaffSummary:m.getStaffSummary,getProjectAssignments:async()=>Promise.resolve([]),assignToProject:async()=>Promise.resolve({success:!0}),updateStaffProjectCount:async()=>Promise.resolve({success:!0}),importFromCSV:c.r.importFromCSV,importFromExcel:c.r.importFromExcel,getImportTemplate:c.r.getImportTemplate||(()=>"Name,Email,Phone,Employee ID,Position,Department"),exportToExcel:p.exportToExcel,import:c.r,export:p}}}]);