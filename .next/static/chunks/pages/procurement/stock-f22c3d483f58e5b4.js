(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8029],{14380:(e,s,t)=>{"use strict";t.r(s),t.d(s,{__N_SSP:()=>j,default:()=>N});var a=t(37876),r=t(14232),l=t(89099),c=t(14952),n=t(88307),o=t(92362),i=t(66691),d=t(91931),m=t(75486),x=t(50843),h=t(75157),g=t(69791),u=t(16932);function p(){let[e]=(0,c.ok)(),{selectedProject:s,permissions:t}=(0,n.KC)()||{},[l,p]=(0,r.useState)(e.get("tab")||"dashboard"),[,j]=(0,r.useState)(!0),[,N]=(0,r.useState)(null),[b,f]=(0,r.useState)({totalItems:0,totalValue:0,lowStockItems:0,outOfStockItems:0,pendingReceipts:0,pendingIssues:0,stockTurnover:0,warehouseUtilization:0});return((0,r.useEffect)(()=>{s&&(async()=>{try{j(!0),await new Promise(e=>setTimeout(e,500)),f({totalItems:147,totalValue:2847593.45,lowStockItems:8,outOfStockItems:3,pendingReceipts:12,pendingIssues:5,stockTurnover:3.2,warehouseUtilization:78.5}),N(null)}catch(e){u.Rm.error("Failed to load stock metrics:",{data:e},"StockManagement"),N("Failed to load stock data. Please try again.")}finally{j(!1)}})()},[s]),s)?(null==t?void 0:t.canAccessStock)?(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Stock Management"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Comprehensive inventory control for ",s.name]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(g.$,{variant:"outline",onClick:()=>{},className:"hidden sm:flex",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Scan Barcode"]}),(0,a.jsxs)(g.$,{variant:"outline",onClick:()=>p("reports"),children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Reports"]}),(0,a.jsxs)(g.$,{variant:"outline",onClick:()=>{window.dispatchEvent(new CustomEvent("stockDataRefresh"))},children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(b.lowStockItems>0||b.outOfStockItems>0)&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(i.A,{className:"h-5 w-5 text-red-600 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-medium text-red-900",children:"Stock Level Alerts"}),(0,a.jsxs)("p",{className:"text-sm text-red-700 mt-1",children:[b.outOfStockItems>0&&"".concat(b.outOfStockItems," item").concat(1!==b.outOfStockItems?"s":""," out of stock. "),b.lowStockItems>0&&"".concat(b.lowStockItems," item").concat(1!==b.lowStockItems?"s":""," below minimum level. "),"Immediate action required to prevent project delays."]})]}),(0,a.jsx)(g.$,{size:"sm",onClick:()=>p("dashboard"),className:"bg-red-600 text-white hover:bg-red-700",children:"View Details"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(o.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Total Items"}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-900",children:b.totalItems.toLocaleString()})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(x.A,{className:"h-5 w-5 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Total Value"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-green-600",children:["R ",(b.totalValue/1e3).toFixed(0),"k"]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,a.jsx)(i.A,{className:"h-5 w-5 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Critical Stock"}),(0,a.jsx)("p",{className:"text-xl font-bold text-red-600",children:b.lowStockItems+b.outOfStockItems})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(h.A,{className:"h-5 w-5 text-orange-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Pending"}),(0,a.jsx)("p",{className:"text-xl font-bold text-orange-600",children:b.pendingReceipts+b.pendingIssues})]})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border p-6",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(o.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Stock Management"}),(0,a.jsx)("p",{className:"mt-2 text-gray-500",children:"This module is under development. Stock management features including inventory dashboard, goods receipts, stock operations, warehouse management, and reporting will be available here."}),(0,a.jsxs)("div",{className:"mt-6 text-sm text-gray-400",children:["Current tab: ",l]})]})})]}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(i.A,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-500",children:"You don't have permission to access stock management features."})]})}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(o.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Project"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Choose a project to access stock management features."})]})})}var j=!0;function N(e){let{projectId:s,projectName:t,initialData:c=[]}=e,n=(0,l.useRouter)(),[o,i]=(0,r.useState)(c),[d,m]=(0,r.useState)(!c.length);(0,r.useEffect)(()=>{c.length||x()},[s]);let x=async()=>{m(!0);try{let e=s?"/api/procurement/stock?projectId=".concat(s):"/api/procurement/stock",t=await fetch(e);if(!t.ok)throw Error("Failed to load stock data");let a=await t.json();i(a.items||[])}catch(e){console.error("Error loading stock data:",e)}finally{m(!1)}};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Stock Management"}),t&&(0,a.jsxs)("p",{className:"mt-2 text-gray-600",children:["Project: ",t]})]}),(0,a.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>{n.push("/procurement/stock/add")},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Add Stock"}),(0,a.jsx)("button",{onClick:()=>{n.push("/procurement/stock/transfer")},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Transfer Stock"}),(0,a.jsx)("button",{onClick:()=>{n.push("/procurement/stock/movements")},className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"View Movements"})]}),d?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"text-gray-500",children:"Loading stock data..."})}):(0,a.jsx)(p,{projectId:s,stockItems:o})]})})}},48945:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/procurement/stock",function(){return t(14380)}])},69791:(e,s,t)=>{"use strict";t.d(s,{$:()=>c});var a=t(37876),r=t(14232),l=t(69241);let c=(0,r.forwardRef)((e,s)=>{let{className:t,variant:r="primary",size:c="md",fullWidth:n=!1,loading:o=!1,disabled:i,children:d,...m}=e;return(0,a.jsxs)("button",{ref:s,className:(0,l.$)("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50 focus:ring-gray-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[r],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[c],n&&"w-full",t),disabled:i||o,...m,children:[o&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),d]})});c.displayName="Button"}},e=>{e.O(0,[3796,8307,8396,636,6593,8792],()=>e(e.s=48945)),_N_E=e.O()}]);