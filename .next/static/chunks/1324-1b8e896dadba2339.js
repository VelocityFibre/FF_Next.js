(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1324],{10665:(e,t,r)=>{"use strict";r.d(t,{gI:()=>n,wq:()=>i,S2:()=>a,_B:()=>c,NQ:()=>s,oF:()=>o,C0:()=>l});var a=function(e){return e.ACTIVE="active",e.INACTIVE="inactive",e.SUSPENDED="suspended",e.PROSPECT="prospect",e.FORMER="former",e.CHURNED="churned",e}({}),n=function(e){return e.ENTERPRISE="enterprise",e.SME="sme",e.RESIDENTIAL="residential",e.GOVERNMENT="government",e.NON_PROFIT="non_profit",e.EDUCATION="education",e.HEALTHCARE="healthcare",e}({}),i=function(e){return e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e.VIP="vip",e}({}),o=function(e){return e.IMMEDIATE="immediate",e.NET_7="net_7",e.NET_14="net_14",e.NET_30="net_30",e.NET_60="net_60",e.NET_90="net_90",e.PREPAID="prepaid",e.ON_DELIVERY="on_delivery",e}({}),s=function(e){return e.EXCELLENT="excellent",e.GOOD="good",e.FAIR="fair",e.POOR="poor",e.UNRATED="unrated",e}({}),c=function(e){return e.EMAIL="email",e.PHONE="phone",e.SMS="sms",e.WHATSAPP="whatsapp",e.IN_PERSON="in_person",e.VIDEO_CALL="video_call",e}({}),l=function(e){return e.FTTH="ftth",e.FTTB="fttb",e.FTTC="fttc",e.BACKBONE="backbone",e.ENTERPRISE="enterprise",e.WIRELESS="wireless",e.MAINTENANCE="maintenance",e.CONSULTING="consulting",e}({})},18930:(e,t,r)=>{"use strict";r.d(t,{H:()=>i});var a=r(82964),n=r(56939);let i={async getAll(e){try{var t,r,i;let o=[(0,a.My)("name","asc")];(null==e||null==(t=e.status)?void 0:t.length)&&o.push((0,a._M)("status","in",e.status)),(null==e||null==(r=e.category)?void 0:r.length)&&o.push((0,a._M)("category","in",e.category)),(null==e||null==(i=e.priority)?void 0:i.length)&&o.push((0,a._M)("priority","in",e.priority)),(null==e?void 0:e.accountManagerId)&&o.push((0,a._M)("accountManagerId","==",e.accountManagerId)),(null==e?void 0:e.city)&&o.push((0,a._M)("city","==",e.city)),(null==e?void 0:e.province)&&o.push((0,a._M)("province","==",e.province));let s=(0,a.P)((0,a.rJ)(n.db,"clients"),...o),c=(await (0,a.GG)(s)).docs.map(e=>({id:e.id,...e.data()}));if(null==e?void 0:e.searchTerm){let t=e.searchTerm.toLowerCase();c=c.filter(e=>e.name.toLowerCase().includes(t)||e.contactPerson.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.phone.includes(t)||e.industry.toLowerCase().includes(t))}return c}catch(e){throw Error("Failed to fetch clients")}},async getById(e){try{let t=(0,a.H9)(n.db,"clients",e),r=await (0,a.x7)(t);if(!r.exists())return null;return{id:r.id,...r.data()}}catch(e){throw Error("Failed to fetch client")}},async create(e){try{let t=a.Dc.now(),r={...e,alternativeEmail:e.alternativeEmail||"",alternativePhone:e.alternativePhone||"",faxNumber:"",website:e.website||"",registrationNumber:e.registrationNumber||"",vatNumber:e.vatNumber||"",currentBalance:0,totalProjects:0,activeProjects:0,completedProjects:0,totalProjectValue:0,averageProjectValue:0,accountManagerName:"",salesRepresentativeName:"",tags:e.tags||[],serviceTypes:e.serviceTypes||[],preferredContractors:[],createdAt:t,updatedAt:t,createdBy:"current-user",lastModifiedBy:"current-user"};return Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]}),(await (0,a.gS)((0,a.rJ)(n.db,"clients"),r)).id}catch(e){throw Error("Failed to create client")}},async update(e,t){try{let r=(0,a.H9)(n.db,"clients",e),i={...t,updatedAt:a.Dc.now(),lastModifiedBy:"current-user"};await (0,a.mZ)(r,i)}catch(e){throw Error("Failed to update client")}},async delete(e){try{let t=(0,a.P)((0,a.rJ)(n.db,"projects"),(0,a._M)("clientId","==",e),(0,a._M)("status","in",["active","planning"]));if(!(await (0,a.GG)(t)).empty)throw Error("Cannot delete client with active projects");await (0,a.kd)((0,a.H9)(n.db,"clients",e))}catch(e){throw Error("Failed to delete client")}},subscribeToClients(e,t){var r;let i=[(0,a.My)("name","asc")];(null==t||null==(r=t.status)?void 0:r.length)&&i.push((0,a._M)("status","in",t.status));let o=(0,a.P)((0,a.rJ)(n.db,"clients"),...i);return(0,a.aQ)(o,t=>{e(t.docs.map(e=>({id:e.id,...e.data()})))})},subscribeToClient(e,t){let r=(0,a.H9)(n.db,"clients",e);return(0,a.aQ)(r,e=>{e.exists()?t({id:e.id,...e.data()}):t(null)})}}},32383:()=>{},49711:(e,t,r)=>{"use strict";r.d(t,{L:()=>g});var a=r(16932);let n="/api",i={async getAll(e){try{let r="".concat(n,"/clients"),a=new URLSearchParams;if(e){var t;(null==(t=e.status)?void 0:t.length)&&e.status.length>0&&a.append("status",e.status[0]),e.searchTerm&&a.append("search",e.searchTerm)}a.toString()&&(r+="?".concat(a.toString()));let i=await fetch(r);if(!i.ok)throw Error("Failed to fetch clients: ".concat(i.status));return(await i.json()).data||[]}catch(e){return a.Rm.error("Error fetching clients:",{error:e},"clientApi"),[]}},async getById(e){try{let t=await fetch("".concat(n,"/clients?id=").concat(e));if(!t.ok)throw Error("Failed to fetch client: ".concat(t.status));return(await t.json()).data||null}catch(t){return a.Rm.error("Error fetching client by ID:",{error:t,id:e},"clientApi"),null}},async getActiveClients(){try{let e=await fetch("".concat(n,"/clients?status=ACTIVE"));if(!e.ok)throw Error("Failed to fetch active clients: ".concat(e.status));return(await e.json()).data||[]}catch(e){return a.Rm.error("Error fetching active clients:",{error:e},"clientApi"),[]}},async getClientSummary(){try{let e=await fetch("".concat(n,"/clients/summary"));if(!e.ok)throw Error("Failed to fetch client summary: ".concat(e.status));return(await e.json()).data||{totalClients:0,activeClients:0,inactiveClients:0,prospectClients:0,totalProjectValue:0,averageProjectValue:0,topClientsByValue:[],clientsByCategory:{},clientsByStatus:{},clientsByPriority:{},monthlyGrowth:0,conversionRate:0}}catch(e){return a.Rm.error("Error fetching client summary:",{error:e},"clientApi"),{totalClients:0,activeClients:0,inactiveClients:0,prospectClients:0,totalProjectValue:0,averageProjectValue:0,topClientsByValue:[],clientsByCategory:{},clientsByStatus:{},clientsByPriority:{},monthlyGrowth:0,conversionRate:0}}},async create(e){try{let t=await fetch("".concat(n,"/clients"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create client: ".concat(t.status));return(await t.json()).data||null}catch(t){return a.Rm.error("Error creating client:",{error:t,clientData:e},"clientApi"),null}},async update(e,t){try{let r=await fetch("".concat(n,"/clients?id=").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to update client: ".concat(r.status));return(await r.json()).data||null}catch(r){return a.Rm.error("Error updating client:",{error:r,id:e,updates:t},"clientApi"),null}},async delete(e){try{let t=await fetch("".concat(n,"/clients?id=").concat(e),{method:"DELETE"});if(!t.ok)throw Error("Failed to delete client: ".concat(t.status));let r=await t.json();return!0===r.success}catch(t){return a.Rm.error("Error deleting client:",{error:t,id:e},"clientApi"),!1}}},o=(i.getAll,i.getById,i.getActiveClients,i.getClientSummary,i.create,i.update,i.delete,"/api");async function s(e){if(!e.ok)throw Error((await e.json().catch(()=>({message:"Request failed"}))).message||"HTTP ".concat(e.status));let t=await e.json();return t.data||t}function c(e){return{id:e.id,name:e.name,companyName:e.name,email:e.email,phone:e.phone,address:e.address,city:e.city||"Johannesburg",province:e.state||"Gauteng",state:e.state,postalCode:e.postal_code||"",country:e.country||"South Africa",type:e.type||"COMPANY",category:e.type||"SME",status:e.status||"ACTIVE",contactPerson:e.contact_person,contactEmail:e.contact_email,contactPhone:e.contact_phone,paymentTerms:e.payment_terms?"NET_".concat(e.payment_terms):"NET_30",creditLimit:1e5,creditRating:"UNRATED",preferredContactMethod:"EMAIL",communicationLanguage:"English",timezone:"Africa/Johannesburg",priority:"MEDIUM",industry:"",serviceTypes:[],tags:[],projectCount:e.project_count||0,activeProjects:e.active_projects||0,totalRevenue:e.total_revenue||0,contractValue:e.total_revenue||0,totalProjectValue:e.total_revenue||0,metadata:e.metadata||{},created_at:e.created_at,updated_at:e.updated_at}}function l(e){return{id:e.id,name:e.name||e.companyName,email:e.email,phone:e.phone,address:e.address,city:e.city,state:e.state||e.province,postal_code:e.postalCode,country:e.country,type:e.type||e.category,status:e.status,contact_person:e.contactPerson,contact_email:e.contactEmail,contact_phone:e.contactPhone,payment_terms:"string"==typeof e.paymentTerms?parseInt(e.paymentTerms.replace(/\D/g,""))||30:e.paymentTerms,metadata:e.metadata}}var u=r(87086),d=r(97501);let p={importFromCSV:async e=>{let{parseCSVFile:t}=await Promise.resolve().then(r.bind(r,97501)),{processImportRows:a}=await Promise.resolve().then(r.bind(r,87086));return a(await t(e))},importFromExcel:async e=>{let{parseExcelFile:t}=await Promise.resolve().then(r.bind(r,97501)),{processImportRows:a}=await Promise.resolve().then(r.bind(r,87086));return a(await t(e))},processImportRows:u.processImportRows,parseEnumValue:d.e1,parseServiceTypes:d.cZ,parseTags:d.rL,parseNumber:d.$J,getImportTemplate:d.D$};var m=r(12770),h=r(18930);let y={async getAll(e){let t=new URLSearchParams;e&&((e.search||e.searchTerm)&&t.append("search",e.search||e.searchTerm),e.status&&t.append("status",e.status),e.type&&t.append("type",e.type));let r=t.toString()?"?".concat(t.toString()):"",a=await fetch("".concat(o,"/clients").concat(r));return(await s(a)).map(c)},async getById(e){let t=await fetch("".concat(o,"/clients?id=").concat(e)),r=await s(t);return r?c(r):null},async create(e){let t=l(e),r=await fetch("".concat(o,"/clients"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return c(await s(r))},async update(e,t){let r=l(t),a=await fetch("".concat(o,"/clients?id=").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return c(await s(a))},delete:async e=>s(await fetch("".concat(o,"/clients?id=").concat(e),{method:"DELETE"})),async getActiveClients(){return await this.getAll()},async getClientSummary(){let e=await this.getAll(),t=new Date,r=t.getMonth(),a=t.getFullYear(),n=e.filter(e=>{if(!e.created_at)return!1;let t=new Date(e.created_at);return t.getMonth()===r&&t.getFullYear()===a}).length,i=e.reduce((e,t)=>e+(t.totalRevenue||0),0);return{totalClients:e.length,activeClients:e.filter(e=>"ACTIVE"===e.status||"active"===e.status).length,newThisMonth:n,totalRevenue:i}}},g={getAll:y.getAll,getById:y.getById,create:y.create,update:y.update,delete:y.delete,getActiveClients:y.getActiveClients,getClientSummary:y.getClientSummary,getContactHistory:async()=>Promise.resolve([]),updateClientMetrics:async()=>Promise.resolve({success:!0}),addContactHistory:async()=>Promise.resolve({success:!0}),import:p,export:{async exportToExcel(e){let t=(e||await h.H.getAll()).map(e=>({"Company Name":e.name,"Contact Person":e.contactPerson,Email:e.email,Phone:e.phone,"Alternative Email":e.alternativeEmail||"","Alternative Phone":e.alternativePhone||"",Address:e.address,City:e.city,Province:e.province,"Postal Code":e.postalCode,Country:e.country,"Registration Number":e.registrationNumber||"","VAT Number":e.vatNumber||"",Industry:e.industry,Website:e.website||"",Status:e.status,Category:e.category,Priority:e.priority,"Credit Limit":e.creditLimit,"Payment Terms":e.paymentTerms,"Credit Rating":e.creditRating,"Current Balance":e.currentBalance,"Total Projects":e.totalProjects,"Active Projects":e.activeProjects,"Completed Projects":e.completedProjects,"Total Project Value":e.totalProjectValue,"Average Project Value":e.averageProjectValue,"Preferred Contact Method":e.preferredContactMethod,"Communication Language":e.communicationLanguage,Timezone:e.timezone,"Service Types":e.serviceTypes.join(", "),Tags:e.tags.join(", "),Notes:e.notes||""})),r=m.Wp.json_to_sheet(t),a=m.Wp.book_new();return m.Wp.book_append_sheet(a,r,"Clients"),r["!cols"]=[{wch:30},{wch:25},{wch:30},{wch:15},{wch:30},{wch:15},{wch:40},{wch:15},{wch:12},{wch:10},{wch:15},{wch:20},{wch:15},{wch:20},{wch:30},{wch:10},{wch:12},{wch:10},{wch:12},{wch:12},{wch:12},{wch:12},{wch:10},{wch:10},{wch:10},{wch:15},{wch:15},{wch:15},{wch:15},{wch:20},{wch:30},{wch:30},{wch:40}],new Blob([m.M9(a,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})},getImportTemplate(){let e=m.Wp.json_to_sheet([{name:"ABC Corporation",contactPerson:"John Smith",email:"john.smith@abccorp.com",phone:"0111234567",alternativeEmail:"info@abccorp.com",alternativePhone:"0119876543",address:"123 Business Street, Sandton",city:"Johannesburg",province:"Gauteng",postalCode:"2196",country:"South Africa",registrationNumber:"2023/123456/07",vatNumber:"VAT123456789",industry:"Technology",website:"www.abccorp.com",status:"active",category:"enterprise",priority:"high",creditLimit:"500000",paymentTerms:"net_30",creditRating:"good",preferredContactMethod:"email",communicationLanguage:"English",timezone:"Africa/Johannesburg",serviceTypes:"ftth,enterprise,maintenance",tags:"premium,long-term",notes:"Key client with multiple locations"}]),t=m.Wp.book_new();m.Wp.book_append_sheet(t,e,"Client Import Template");let r=this.getInstructionsData(),a=m.Wp.json_to_sheet(r);return m.Wp.book_append_sheet(t,a,"Instructions"),new Blob([m.M9(t,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})},getInstructionsData:()=>[{Field:"name",Required:"Yes",Description:"Company or organization name"},{Field:"contactPerson",Required:"Yes",Description:"Primary contact person's full name"},{Field:"email",Required:"Yes",Description:"Primary email address"},{Field:"phone",Required:"Yes",Description:"Primary phone number"},{Field:"alternativeEmail",Required:"No",Description:"Alternative email address"},{Field:"alternativePhone",Required:"No",Description:"Alternative phone number"},{Field:"address",Required:"No",Description:"Street address"},{Field:"city",Required:"No",Description:"City (defaults to Johannesburg)"},{Field:"province",Required:"No",Description:"Province (defaults to Gauteng)"},{Field:"postalCode",Required:"No",Description:"Postal code"},{Field:"country",Required:"No",Description:"Country (defaults to South Africa)"},{Field:"registrationNumber",Required:"No",Description:"Company registration number"},{Field:"vatNumber",Required:"No",Description:"VAT registration number"},{Field:"industry",Required:"No",Description:"Industry or business sector"},{Field:"website",Required:"No",Description:"Company website URL"},{Field:"status",Required:"No",Description:"Status: active, inactive, suspended, prospect, former"},{Field:"category",Required:"No",Description:"Category: enterprise, sme, residential, government, non_profit, education, healthcare"},{Field:"priority",Required:"No",Description:"Priority: low, medium, high, critical, vip"},{Field:"creditLimit",Required:"No",Description:"Credit limit in ZAR (defaults to 100000)"},{Field:"paymentTerms",Required:"No",Description:"Payment terms: immediate, net_7, net_14, net_30, net_60, net_90, prepaid"},{Field:"creditRating",Required:"No",Description:"Credit rating: excellent, good, fair, poor, unrated"},{Field:"preferredContactMethod",Required:"No",Description:"Contact method: email, phone, sms, whatsapp, in_person, video_call"},{Field:"communicationLanguage",Required:"No",Description:"Preferred language (defaults to English)"},{Field:"timezone",Required:"No",Description:"Timezone (defaults to Africa/Johannesburg)"},{Field:"serviceTypes",Required:"No",Description:"Comma-separated: ftth, fttb, fttc, backbone, enterprise, wireless, maintenance, consulting"},{Field:"tags",Required:"No",Description:"Comma-separated tags for categorization"},{Field:"notes",Required:"No",Description:"Additional notes or comments"}]}}},56939:(e,t,r)=>{"use strict";r.d(t,{db:()=>d});var a=r(16042),n=r(76559),i=r(82964),o=r(22128),s=r(65364);let c={apiKey:s.env.NEXT_PUBLIC_FIREBASE_API_KEY||"AIzaSyDvW-ImXptnYIX7IDR78pdruw9BAp5A8Q8",authDomain:s.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"fibreflow-292c7.firebaseapp.com",projectId:s.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"fibreflow-292c7",storageBucket:s.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||"fibreflow-292c7.firebasestorage.app",messagingSenderId:s.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID||"178707510767",appId:s.env.NEXT_PUBLIC_FIREBASE_APP_ID||"1:178707510767:web:a9455c8f053de03fbff21a",measurementId:s.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID||"G-3S74XHZ49B"},l=0===(0,a.Dk)().length?(0,a.Wp)(c):(0,a.Sx)(),u=(0,n.xI)(l),d=(0,i.aU)(l),p=(0,o.c7)(l);if("true"===s.env.NEXT_PUBLIC_ENABLE_OFFLINE&&(0,i.Q5)(d).catch(e=>{"failed-precondition"===e.code?console.warn("Firebase persistence failed: Multiple tabs open"):"unimplemented"===e.code&&console.warn("Firebase persistence not available in this browser")}),"development"===s.env.NEXT_PUBLIC_APP_ENV&&"true"===s.env.NEXT_PUBLIC_USE_EMULATORS)try{(0,n.Wq)(u,"http://localhost:9099",{disableWarnings:!0}),(0,i.vN)(d,"localhost",8080),(0,o.nb)(p,"localhost",9199),console.log("\uD83D\uDD27 Connected to Firebase emulators")}catch(e){console.debug("Firebase emulators connection skipped:",e)}},83686:()=>{},87086:(e,t,r)=>{"use strict";r.d(t,{processImportRows:()=>o});var a=r(10665),n=r(18930),i=r(97501);async function o(e){let{validRows:t,invalidRows:r,allErrors:o}=function(e){let t=[],r=[],a=[];for(let n=0;n<e.length;n++){let i=e[n],o=function(e,t){var r,a;let n=[];return e.name||n.push({row:t,field:"name",message:"Company name is required"}),e.contactPerson||n.push({row:t,field:"contactPerson",message:"Contact person is required"}),e.email?(r=e.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)||n.push({row:t,field:"email",message:"Invalid email format"})):n.push({row:t,field:"email",message:"Email is required"}),e.phone?(a=e.phone,/^[+]?[0-9\s\-()]{10,}$/.test(a)||n.push({row:t,field:"phone",message:"Invalid phone format"})):n.push({row:t,field:"phone",message:"Phone is required"}),n}(i,n+2);0===o.length?t.push(i):(r.push({row:i,errors:o}),a.push(...o))}return{validRows:t,invalidRows:r,allErrors:a}}(e),s=[...o],c=[],l=0,u=r.length;for(let r=0;r<t.length;r++){let o=t[r],p=e.indexOf(o)+2;try{var d;let e={name:(d=o).name,contactPerson:d.contactPerson,email:d.email,phone:d.phone,address:{street:d.address||"",city:d.city||"Johannesburg",state:d.province||"Gauteng",postalCode:d.postalCode||"",country:d.country||"South Africa"},city:d.city||"Johannesburg",province:d.province||"Gauteng",postalCode:d.postalCode||"",country:d.country||"South Africa",registrationNumber:d.registrationNumber||"",vatNumber:d.vatNumber||"",industry:d.industry||"General",website:d.website||"",alternativeEmail:d.alternativeEmail||"",alternativePhone:d.alternativePhone||"",creditLimit:(0,i.$J)(d.creditLimit,1e5),paymentTerms:(0,i.e1)(d.paymentTerms,a.oF,a.oF.NET_30),creditRating:(0,i.e1)(d.creditRating,a.NQ,a.NQ.UNRATED),status:(0,i.e1)(d.status,a.S2,a.S2.PROSPECT),category:(0,i.e1)(d.category,a.gI,a.gI.SME),priority:(0,i.e1)(d.priority,a.wq,a.wq.MEDIUM),preferredContactMethod:(0,i.e1)(d.preferredContactMethod,a._B,a._B.EMAIL),communicationLanguage:d.communicationLanguage||"English",timezone:d.timezone||"Africa/Johannesburg",notes:d.notes||"",tags:(0,i.rL)(d.tags),serviceTypes:(0,i.cZ)(d.serviceTypes,a.C0),specialRequirements:""},t=await n.H.create(e),r=await n.H.getById(t);r&&(c.push(r),l++)}catch(e){s.push({row:p,field:"general",message:e.message||"Failed to import row",value:o}),u++}}return{success:0===u,imported:l,failed:u,errors:s,clients:c}}},97501:(e,t,r)=>{"use strict";r.d(t,{$J:()=>c,D$:()=>u,cZ:()=>o,e1:()=>l,parseCSVFile:()=>n,parseExcelFile:()=>i,rL:()=>s});var a=r(12770);async function n(e){return new Promise((t,r)=>{let a=new FileReader;a.onload=async e=>{try{var a;let r=(null==(a=e.target)?void 0:a.result).split("\n").filter(e=>e.trim()),n=r[0].split(",").map(e=>e.trim()),i=[];for(let e=1;e<r.length;e++){let t=r[e].split(",").map(e=>e.trim()),a={};n.forEach((e,r)=>{a[e]=t[r]||""}),i.push(a)}t(i)}catch(e){r(e)}},a.onerror=()=>r(Error("Failed to read CSV file")),a.readAsText(e)})}async function i(e){return new Promise((t,r)=>{let n=new FileReader;n.onload=async e=>{try{var n;let r=null==(n=e.target)?void 0:n.result,i=a.LF(r,{type:"binary"}),o=i.SheetNames[0],s=i.Sheets[o],c=a.Wp.sheet_to_json(s);t(c)}catch(e){r(e)}},n.onerror=()=>r(Error("Failed to read Excel file")),n.readAsBinaryString(e)})}function o(e,t){if(!e)return[];let r=[];for(let a of e.split(",").map(e=>e.trim())){let e=l(a,t,null);e&&r.push(e)}return r}function s(e){return e?e.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]}function c(e,t){if(void 0===e||""===e)return t;let r="string"==typeof e?parseFloat(e):e;return isNaN(r)?t:r}function l(e,t,r){if(!e)return r;let a=e.toUpperCase().replace(/\s+/g,"_");for(let e of Object.values(t))if(e.toUpperCase().replace(/\s+/g,"_")===a)return e;return r}function u(){let e=a.Wp.json_to_sheet([{name:"Example Client",code:"CLI001",email:"client@example.com",phone:"+27123456789",status:"ACTIVE",category:"BUSINESS",priority:"HIGH",website:"https://example.com","registration Number":"REG123456","vat Number":"VAT123456","tax Number":"TAX123456","physical Address":"123 Main Street","physical City":"Johannesburg","physical Province":"Gauteng","physical Postal Code":"2000","physical Country":"South Africa","postal Address":"PO Box 123","postal City":"Johannesburg","postal Province":"Gauteng","postal Postal Code":"2001","postal Country":"South Africa","billing Address":"123 Main Street","billing City":"Johannesburg","billing Province":"Gauteng","billing Postal Code":"2000","billing Country":"South Africa","contact First Name":"John","contact Last Name":"Doe","contact Email":"john@example.com","contact Phone":"+27123456789","contact Position":"Manager","contact Preferred Method":"EMAIL","payment Terms":"NET_30","credit Limit":"100000","credit Rating":"GOOD",services:"INSTALLATION,MAINTENANCE",tags:"premium,vip",notes:"Important client"}]),t=a.Wp.book_new();return a.Wp.book_append_sheet(t,e,"Clients"),new Blob([a.M9(t,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}}}]);