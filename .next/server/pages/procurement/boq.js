"use strict";(()=>{var a={};a.id=5229,a.ids=[636,3220,5229],a.modules={4202:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{C:()=>l});var e=c(82015),f=c(13984),g=c(24341),h=c(42893),i=c(49888),j=c(94690),k=a([f,h]);[f,h]=k.then?(await k)():k;let l=a=>{let{context:b}=(0,f.J)(),[c,d]=(0,e.useState)([]),[k,l]=(0,e.useState)(j.tV),[m,n]=(0,e.useState)("createdAt"),[o,p]=(0,e.useState)("desc"),[q,r]=(0,e.useState)(!0),[s,t]=(0,e.useState)(!1),[u,v]=(0,e.useState)(null);(0,e.useEffect)(()=>{w()},[b]);let w=async()=>{if(b)try{r(!0);let a=await g.Mm.getBOQsByProject(b,b.projectId);d(a)}catch(a){i.Rm.error("Failed to load BOQs:",{data:a},"useBOQList"),h.default.error("Failed to load BOQs")}finally{r(!1)}},x=(0,e.useMemo)(()=>({uploaders:[...new Set(c.map(a=>a.uploadedBy).filter(Boolean))]}),[c]),y=(0,e.useMemo)(()=>{let a=c.filter(a=>{if(k.search){let b=k.search.toLowerCase();if(!a.title?.toLowerCase().includes(b)&&!a.fileName?.toLowerCase().includes(b)&&!a.description?.toLowerCase().includes(b))return!1}if(k.status&&a.status!==k.status||k.mappingStatus&&a.mappingStatus!==k.mappingStatus||k.uploadedBy&&a.uploadedBy!==k.uploadedBy)return!1;if("all"!==k.dateRange){let b=new Date,c=new Date(a.createdAt),d=Math.floor((b.getTime()-c.getTime())/864e5);switch(k.dateRange){case"7days":if(d>7)return!1;break;case"30days":if(d>30)return!1;break;case"90days":if(d>90)return!1}}return!0});return a.sort((a,b)=>{let c,d;switch(m){case"createdAt":c=new Date(a.createdAt).getTime(),d=new Date(b.createdAt).getTime();break;case"version":c=a.version,d=b.version;break;case"itemCount":c=a.itemCount||0,d=b.itemCount||0;break;case"mappingProgress":c=a.mappingProgress||0,d=b.mappingProgress||0;break;case"status":c=a.status,d=b.status;break;default:return 0}return"asc"===o?c<d?-1:+(c>d):c>d?-1:+(c<d)}),a},[c,k,m,o]),z=async a=>{try{let b=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`${a.fileName||"boq"}_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),h.default.success("BOQ downloaded successfully")}catch(a){i.Rm.error("Failed to download BOQ:",{data:a},"useBOQList"),h.default.error("Failed to download BOQ")}v(null)},A=async a=>{try{d(b=>b.map(b=>b.id===a.id?{...b,status:"archived"}:b)),h.default.success("BOQ archived successfully")}catch(a){i.Rm.error("Failed to archive BOQ:",{data:a},"useBOQList"),h.default.error("Failed to archive BOQ")}v(null)},B=async a=>{if(window.confirm("Are you sure you want to delete this BOQ? This action cannot be undone.")){try{await g.Mm.deleteBOQ(b,a.id),d(b=>b.filter(b=>b.id!==a.id)),h.default.success("BOQ deleted successfully")}catch(a){i.Rm.error("Failed to delete BOQ:",{data:a},"useBOQList"),h.default.error("Failed to delete BOQ")}v(null)}};return{boqs:c,filteredAndSortedBOQs:y,filters:k,setFilters:l,sortField:m,sortDirection:o,handleSort:a=>{m===a?p(a=>"asc"===a?"desc":"asc"):(n(a),p("asc"))},isLoading:q,showFilters:s,setShowFilters:t,actionMenuOpen:u,setActionMenuOpen:v,filterOptions:x,loadBOQs:w,handleViewBOQ:b=>{a?.(b),v(null)},handleEditBOQ:a=>{v(null)},handleDownloadBOQ:z,handleArchiveBOQ:A,handleDeleteBOQ:B}};d()}catch(a){d(a)}})},8732:a=>{a.exports=require("react/jsx-runtime")},13984:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>h});var e=c(73106),f=c(18275),g=a([e]);function h(){let{user:a,isLoading:b}=(0,e.A)(),{currentProject:c,isLoading:d}=(0,f.B)(),g=a?c?null:"No project selected":"User not authenticated",h=a&&c?{userId:a.id,userName:a.name||a.email||"Unknown User",projectId:c.id,projectName:c.name,permissions:{canCreateBOQ:!0,canEditBOQ:!0,canDeleteBOQ:!1,canApproveBOQ:!1,canCreateRFQ:!0,canEditRFQ:!0,canDeleteRFQ:!1,canCreatePO:!0,canEditPO:!0,canDeletePO:!1,canApprovePO:!1,canManageStock:!0,canViewReports:!0,isAdmin:!1},metadata:{userEmail:a.email||"",timestamp:new Date}}:null;return{context:h,isLoading:b||d,error:g,hasContext:!!h}}e=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},15369:(a,b,c)=>{c.d(b,{A:()=>h});var d=c(8732),e=c(82015),f=c(74952),g=c(94690);function h({boq:a,isSelected:b=!1,onClick:c,onView:h,onEdit:i,onDownload:j,onArchive:k,onDelete:l,actionMenuOpen:m,setActionMenuOpen:n}){let o=(0,e.useRef)(null);return(0,d.jsx)("div",{className:`bg-white rounded-lg border p-4 hover:shadow-md transition-shadow cursor-pointer ${b?"border-blue-500 shadow-md":"border-gray-200"}`,onClick:c,children:(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)(f.iUU,{className:"h-5 w-5 text-blue-500 flex-shrink-0"}),(0,d.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900 truncate",children:a.title||a.fileName}),(0,d.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,d.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g.NQ[a.status]}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)}),(0,d.jsxs)("span",{className:"text-sm text-gray-500",children:["v",a.version]})]})]})]}),(0,d.jsxs)("div",{className:"mt-3 flex items-center space-x-4 text-sm text-gray-500",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(f.VvS,{className:"h-4 w-4 mr-1"}),new Date(a.createdAt).toLocaleDateString()]}),(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(f.KJW,{className:"h-4 w-4 mr-1"}),a.uploadedBy]}),(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(f.iUU,{className:"h-4 w-4 mr-1"}),a.itemCount||0," items"]})]}),a.description&&(0,d.jsx)("p",{className:"mt-2 text-sm text-gray-600 line-clamp-2",children:a.description}),(0,d.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(a=>{switch(a){case"mapped":return(0,d.jsx)(f.rAV,{className:"h-4 w-4 text-green-500"});case"mapping":return(0,d.jsx)(f.zD7,{className:"h-4 w-4 text-yellow-500"});case"exception":return(0,d.jsx)(f.hcu,{className:"h-4 w-4 text-red-500"});default:return(0,d.jsx)(f.zD7,{className:"h-4 w-4 text-gray-500"})}})(a.mappingStatus||"pending"),(0,d.jsx)("span",{className:`ml-1 px-2 py-1 rounded-full text-xs font-medium ${g.$b[a.mappingStatus||"pending"]}`,children:a.mappingStatus||"Pending"})]}),a.itemCount>0&&(0,d.jsxs)("div",{className:"text-sm text-gray-500",children:[Math.round(a.mappedItems/a.itemCount*100),"% mapped"]})]}),a.itemCount>0&&(0,d.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.round(a.mappedItems/a.itemCount*100)}%`}})})]})]}),(0,d.jsxs)("div",{className:"relative ml-4",ref:o,children:[(0,d.jsx)("button",{onClick:a=>{a.stopPropagation(),n(!m)},className:"p-1 text-gray-500 hover:text-gray-700",children:(0,d.jsx)(f.GvN,{className:"h-5 w-5"})}),m&&(0,d.jsx)("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-10",children:(0,d.jsxs)("div",{className:"py-1",children:[(0,d.jsxs)("button",{onClick:a=>{a.stopPropagation(),h()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,d.jsx)(f.kU3,{className:"h-4 w-4 mr-3"}),"View Details"]}),(0,d.jsxs)("button",{onClick:a=>{a.stopPropagation(),i()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,d.jsx)(f.W7n,{className:"h-4 w-4 mr-3"}),"Edit BOQ"]}),(0,d.jsxs)("button",{onClick:a=>{a.stopPropagation(),j()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,d.jsx)(f.f5X,{className:"h-4 w-4 mr-3"}),"Download"]}),(0,d.jsx)("div",{className:"border-t border-gray-100"}),(0,d.jsxs)("button",{onClick:a=>{a.stopPropagation(),k()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,d.jsx)(f.Tde,{className:"h-4 w-4 mr-3"}),"Archive"]}),(0,d.jsxs)("button",{onClick:a=>{a.stopPropagation(),l()},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center",children:[(0,d.jsx)(f.TBR,{className:"h-4 w-4 mr-3"}),"Delete"]})]})})]})]})})}},18275:(a,b,c)=>{c.d(b,{B:()=>h});var d=c(82015),e=c(44233),f=c(71423),g=c(49888);function h(){let a=(0,e.useRouter)(),b="string"==typeof a.query.projectId?a.query.projectId:void 0,[c,h]=(0,d.useState)(null),[i,j]=(0,d.useState)(!1),[k,l]=(0,d.useState)(null),m=async a=>{try{j(!0),l(null);let b=await f.Q.getById(a);h(b)}catch(a){g.Rm.error("Failed to load project:",{data:a},"useProject"),l(a instanceof Error?a.message:"Failed to load project"),h(null)}finally{j(!1)}};return{currentProject:c,isLoading:i,error:k,setCurrentProject:h,refreshProject:async()=>{b&&await m(b)}}}},22326:a=>{a.exports=require("react-dom")},24341:(a,b,c)=>{c.d(b,{Mm:()=>k});let d="/api/procurement";async function e(a){let b=await a.json();if(!b.success)throw Error(b.error||"API request failed");return b.data||b}let f=async()=>e(await fetch(`${d}?resource=health`,{method:"GET"})),g={stock:{async getPositions(a,b){let c=new URLSearchParams({resource:"stock",projectId:a,...b});return e(await fetch(`${d}?${c}`,{method:"GET"}))},getPosition:async(a,b)=>e(await fetch(`${d}?resource=stock&projectId=${a}&id=${b}`,{method:"GET"})),createPosition:async(a,b)=>e(await fetch(`${d}?resource=stock&projectId=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})),updatePosition:async(a,b,c)=>e(await fetch(`${d}?resource=stock&projectId=${a}&id=${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})),async deletePosition(a,b){let c=await fetch(`${d}?resource=stock&projectId=${a}&id=${b}`,{method:"DELETE"});await e(c)},async getMovements(a,b){let c=new URLSearchParams({resource:"stock",action:"movements",projectId:a,...b});return e(await fetch(`${d}?${c}`,{method:"GET"}))},createMovement:async(a,b)=>e(await fetch(`${d}?resource=stock&action=movement&projectId=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})),processBulkMovement:async(a,b)=>e(await fetch(`${d}?resource=stock&action=bulk-movement&projectId=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})),getDashboard:async a=>e(await fetch(`${d}?resource=stock&action=dashboard&projectId=${a}`,{method:"GET"}))},purchaseOrders:{async getOrders(a,b){let c=new URLSearchParams({resource:"purchase-orders",projectId:a,...b});return e(await fetch(`${d}?${c}`,{method:"GET"}))},getOrder:async(a,b)=>e(await fetch(`${d}?resource=purchase-orders&projectId=${a}&id=${b}`,{method:"GET"})),createOrder:async(a,b)=>e(await fetch(`${d}?resource=purchase-orders&projectId=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})),updateOrder:async(a,b,c)=>e(await fetch(`${d}?resource=purchase-orders&projectId=${a}&id=${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})),async deleteOrder(a,b){let c=await fetch(`${d}?resource=purchase-orders&projectId=${a}&id=${b}`,{method:"DELETE"});await e(c)}},rfq:{async getRFQs(a,b){let c=new URLSearchParams({resource:"rfq",projectId:a,...b});return e(await fetch(`${d}?${c}`,{method:"GET"}))},getRFQ:async(a,b)=>e(await fetch(`${d}?resource=rfq&projectId=${a}&id=${b}`,{method:"GET"})),createRFQ:async(a,b)=>e(await fetch(`${d}?resource=rfq&projectId=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})),updateRFQ:async(a,b,c)=>e(await fetch(`${d}?resource=rfq&projectId=${a}&id=${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})),async deleteRFQ(a,b){let c=await fetch(`${d}?resource=rfq&projectId=${a}&id=${b}`,{method:"DELETE"});await e(c)},getSupplierHistory:async(a,b)=>e(await fetch(`${d}?resource=rfq&action=supplier-history&projectId=${a}&supplierId=${b}`,{method:"GET"})),async addSuppliers(a,b,c){let f=await fetch(`${d}?resource=rfq&action=add-suppliers&projectId=${a}&id=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplierIds:c})});await e(f)},async replaceSuppliers(a,b,c){let f=await fetch(`${d}?resource=rfq&action=replace-suppliers&projectId=${a}&id=${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplierIds:c})});await e(f)},async removeSuppliers(a,b,c){let f=await fetch(`${d}?resource=rfq&action=remove-suppliers&projectId=${a}&id=${b}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplierIds:c})});await e(f)}},boq:{async getBOQs(a,b){let c=new URLSearchParams({resource:"boq",projectId:a,...b});return e(await fetch(`${d}?${c}`,{method:"GET"}))},getBOQ:async(a,b)=>e(await fetch(`${d}?resource=boq&projectId=${a}&id=${b}`,{method:"GET"})),createBOQ:async(a,b)=>e(await fetch(`${d}?resource=boq&projectId=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})),updateBOQ:async(a,b,c)=>e(await fetch(`${d}?resource=boq&projectId=${a}&id=${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})),async deleteBOQ(a,b){let c=await fetch(`${d}?resource=boq&projectId=${a}&id=${b}`,{method:"DELETE"});await e(c)},getItems:async(a,b)=>e(await fetch(`${d}?resource=boq&action=items&projectId=${a}&boqId=${b}`,{method:"GET"})),getExceptions:async(a,b)=>e(await fetch(`${d}?resource=boq&action=exceptions&projectId=${a}&boqId=${b}`,{method:"GET"})),importBOQ:async(a,b)=>e(await fetch(`${d}?resource=boq&action=import&projectId=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})),async performMapping(a,b,c){let f=await fetch(`${d}?resource=boq&action=map&projectId=${a}&id=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mappings:c})});await e(f)},async resolveException(a,b,c){let f=await fetch(`${d}?resource=boq&action=resolve-exception&projectId=${a}&id=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});await e(f)}},healthCheck:f};class h{static async getStockPositions(a,b){let c=await g.stock.getPositions(a.projectId,b);return{positions:c.data,total:c.total,page:c.page,limit:c.limit}}static async getStockPositionById(a,b){return g.stock.getPosition(a.projectId,b)}static async createStockPosition(a,b){return g.stock.createPosition(a.projectId,b)}static async updateStockPosition(a,b,c){return g.stock.updatePosition(a.projectId,b,c)}static async getStockMovements(a,b){let c=await g.stock.getMovements(a.projectId,b);return{movements:c.data,total:c.total,page:c.page,limit:c.limit}}static async createStockMovement(a,b){return g.stock.createMovement(a.projectId,b)}static async processBulkMovement(a,b){return g.stock.processBulkMovement(a.projectId,{...b,userId:a.userId})}static async getDashboardData(a){return g.stock.getDashboard(a.projectId)}static async getBOQsByProject(a,b){return(await g.boq.getBOQs(b)).data}static async getBOQ(a,b){return g.boq.getBOQ(a.projectId,b)}static async getBOQWithItems(a,b){let[c,d,e]=await Promise.all([g.boq.getBOQ(a.projectId,b),g.boq.getItems(a.projectId,b),g.boq.getExceptions(a.projectId,b)]);return{...c,items:d,exceptions:e}}static async createBOQ(a,b){return g.boq.createBOQ(a.projectId,{...b,createdBy:a.userId})}static async updateBOQ(a,b,c){return g.boq.updateBOQ(a.projectId,b,c)}static async deleteBOQ(a,b){return g.boq.deleteBOQ(a.projectId,b)}static async importBOQ(a,b){return g.boq.importBOQ(a.projectId,b)}static async getBOQItems(a,b){return await g.boq.getItems(a.projectId,b)}static async getBOQItem(a,b){throw Error("getBOQItem not implemented - API endpoint needed")}static async createBOQItem(a,b,c){throw Error("createBOQItem not implemented - API endpoint needed")}static async updateBOQItem(a,b,c){throw Error("updateBOQItem not implemented - API endpoint needed")}static async deleteBOQItem(a,b){throw Error("deleteBOQItem not implemented - API endpoint needed")}static async getBOQExceptions(a,b){return await g.boq.getExceptions(a.projectId,b)}static async getBOQException(a,b){throw Error("getBOQException not implemented - API endpoint needed")}static async createBOQException(a,b,c){throw Error("createBOQException not implemented - API endpoint needed")}static async updateBOQException(a,b,c){throw Error("updateBOQException not implemented - API endpoint needed")}static async deleteException(a,b){throw Error("deleteException not implemented - API endpoint needed")}static async getRFQList(a,b){let c=await g.rfq.getRFQs(a.projectId,b);return{rfqs:c.data,total:c.total,page:c.page,limit:c.limit}}static async getRFQById(a,b){return g.rfq.getRFQ(a.projectId,b)}static async createRFQ(a,b){return g.rfq.createRFQ(a.projectId,{...b,createdBy:a.userId})}static async updateRFQ(a,b,c){return g.rfq.updateRFQ(a.projectId,b,c)}static async deleteRFQ(a,b){return g.rfq.deleteRFQ(a.projectId,b)}static async getPurchaseOrders(a,b){let c=await g.purchaseOrders.getOrders(a.projectId,b);return{orders:c.data,total:c.total,page:c.page,limit:c.limit}}static async getPurchaseOrderById(a,b){return g.purchaseOrders.getOrder(a.projectId,b)}static async createPurchaseOrder(a,b){return g.purchaseOrders.createOrder(a.projectId,{...b,createdBy:a.userId})}static async updatePurchaseOrder(a,b,c){return g.purchaseOrders.updateOrder(a.projectId,b,c)}static async deletePurchaseOrder(a,b){return g.purchaseOrders.deleteOrder(a.projectId,b)}static async getHealthStatus(){return g.healthCheck()}}let i={getBOQWithItems:h.getBOQWithItems,getBOQsByProject:h.getBOQsByProject,getBOQ:h.getBOQ,updateBOQ:h.updateBOQ,deleteBOQ:h.deleteBOQ,createBOQ:h.createBOQ,importBOQ:h.importBOQ,getBOQItems:h.getBOQItems,getBOQItem:h.getBOQItem,createBOQItem:h.createBOQItem,updateBOQItem:h.updateBOQItem,deleteBOQItem:h.deleteBOQItem,getBOQExceptions:h.getBOQExceptions,getBOQException:h.getBOQException,createBOQException:h.createBOQException,updateBOQException:h.updateBOQException,deleteException:h.deleteException,getStockPositions:h.getStockPositions,getStockPositionById:h.getStockPositionById,createStockPosition:h.createStockPosition,updateStockPosition:h.updateStockPosition,getStockMovements:h.getStockMovements,createStockMovement:h.createStockMovement,processBulkMovement:h.processBulkMovement,getDashboardData:h.getDashboardData,getRFQList:h.getRFQList,getRFQById:h.getRFQById,createRFQ:h.createRFQ,updateRFQ:h.updateRFQ,deleteRFQ:h.deleteRFQ,getPurchaseOrders:h.getPurchaseOrders,getPurchaseOrderById:h.getPurchaseOrderById,createPurchaseOrder:h.createPurchaseOrder,updatePurchaseOrder:h.updatePurchaseOrder,deletePurchaseOrder:h.deletePurchaseOrder,getHealthStatus:h.getHealthStatus};class j{static{this.getBOQWithItems=h.getBOQWithItems}static{this.getBOQsByProject=h.getBOQsByProject}static{this.getBOQ=h.getBOQ}static{this.updateBOQ=h.updateBOQ}static{this.deleteBOQ=h.deleteBOQ}static{this.createBOQ=h.createBOQ}static{this.getBOQItems=h.getBOQItems}static{this.getBOQItem=h.getBOQItem}static{this.createBOQItem=h.createBOQItem}static{this.updateBOQItem=h.updateBOQItem}static{this.deleteBOQItem=h.deleteBOQItem}static{this.getBOQExceptions=h.getBOQExceptions}static{this.getBOQException=h.getBOQException}static{this.createBOQException=h.createBOQException}static{this.updateBOQException=h.updateBOQException}static{this.deleteException=h.deleteException}}let k=i},27910:a=>{a.exports=require("stream")},28462:a=>{a.exports=import("@tanstack/react-query")},29021:a=>{a.exports=require("fs")},33873:a=>{a.exports=require("path")},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},42893:a=>{a.exports=import("react-hot-toast")},45109:(a,b,c)=>{c.r(b),c.d(b,{default:()=>f});var d=c(8732),e=c(82341);function f(){return(0,d.jsxs)(e.Html,{lang:"en",children:[(0,d.jsxs)(e.Head,{children:[(0,d.jsx)("meta",{name:"description",content:"FibreFlow - Fiber Network Project Management"}),(0,d.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,d.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,d.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,d.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"})]}),(0,d.jsxs)("body",{className:"min-h-screen bg-background font-sans antialiased",children:[(0,d.jsx)(e.Main,{}),(0,d.jsx)(e.NextScript,{})]})]})}},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},46200:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>q,default:()=>m,getServerSideProps:()=>p,getStaticPaths:()=>o,getStaticProps:()=>n,handler:()=>y,reportWebVitals:()=>r,routeModule:()=>x,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>u,unstable_getStaticPaths:()=>t,unstable_getStaticProps:()=>s});var e=c(63885),f=c(80237),g=c(81413),h=c(45109),i=c(80363),j=c(87605),k=c(12289),l=a([i,j]);[i,j]=l.then?(await l)():l;let m=(0,g.M)(j,"default"),n=(0,g.M)(j,"getStaticProps"),o=(0,g.M)(j,"getStaticPaths"),p=(0,g.M)(j,"getServerSideProps"),q=(0,g.M)(j,"config"),r=(0,g.M)(j,"reportWebVitals"),s=(0,g.M)(j,"unstable_getStaticProps"),t=(0,g.M)(j,"unstable_getStaticPaths"),u=(0,g.M)(j,"unstable_getStaticParams"),v=(0,g.M)(j,"unstable_getServerProps"),w=(0,g.M)(j,"unstable_getServerSideProps"),x=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/procurement/boq",pathname:"/procurement/boq",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:i.default,Document:h.default},userland:j}),y=(0,k.U)({srcPage:"/procurement/boq",config:q,userland:j,routeModule:x,getStaticPaths:o,getStaticProps:n,getServerSideProps:p});d()}catch(a){d(a)}})},49262:(a,b,c)=>{c.d(b,{A:()=>g});var d=c(8732),e=c(74952),f=c(94690);function g({filters:a,setFilters:b,uploaders:c}){return(0,d.jsxs)("div",{className:"bg-white p-4 rounded-lg border space-y-3",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[(0,d.jsxs)("div",{className:"relative md:col-span-2",children:[(0,d.jsx)(e.vji,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,d.jsx)("input",{type:"text",placeholder:"Search BOQs...",value:a.search,onChange:c=>b({...a,search:c.target.value}),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md text-sm"})]}),(0,d.jsxs)("select",{value:a.status,onChange:c=>b({...a,status:c.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,d.jsx)("option",{value:"",children:"All Statuses"}),Object.entries(f.E).map(([a,b])=>(0,d.jsx)("option",{value:a,children:b},a))]}),(0,d.jsxs)("select",{value:a.mappingStatus,onChange:c=>b({...a,mappingStatus:c.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,d.jsx)("option",{value:"",children:"All Mapping"}),Object.entries(f.AA).map(([a,b])=>(0,d.jsx)("option",{value:a,children:b},a))]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(e.KJW,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,d.jsxs)("select",{value:a.uploadedBy,onChange:c=>b({...a,uploadedBy:c.target.value}),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md text-sm",children:[(0,d.jsx)("option",{value:"",children:"All Users"}),c.map(a=>(0,d.jsx)("option",{value:a,children:a},a))]})]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(e.VvS,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,d.jsxs)("select",{value:a.dateRange,onChange:c=>b({...a,dateRange:c.target.value}),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm",children:[(0,d.jsx)("option",{value:"all",children:"All Time"}),(0,d.jsx)("option",{value:"7days",children:"Last 7 Days"}),(0,d.jsx)("option",{value:"30days",children:"Last 30 Days"}),(0,d.jsx)("option",{value:"90days",children:"Last 90 Days"})]})]}),Object.values(a).some(a=>""!==a&&"all"!==a)&&(0,d.jsx)("button",{onClick:()=>b(f.tV),className:"text-sm text-blue-600 hover:text-blue-700",children:"Clear filters"})]})]})}},69522:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732),e=c(74952);function f({totalBOQs:a,filteredCount:b,showFilters:c,setShowFilters:f,onCreateBOQ:g,onUploadBOQ:h,onRefresh:i}){return(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Bill of Quantities"}),(0,d.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:b===a?`${a} BOQs`:`${b} of ${a} BOQs`})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsxs)("button",{onClick:()=>f(!c),className:`px-3 py-2 border rounded-md text-sm font-medium flex items-center ${c?"bg-blue-50 border-blue-200 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[(0,d.jsx)(e.dJT,{className:"h-4 w-4 mr-2"}),"Filters"]}),(0,d.jsxs)("button",{onClick:i,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-md text-sm font-medium hover:bg-gray-50 flex items-center",children:[(0,d.jsx)(e.e9t,{className:"h-4 w-4 mr-2"}),"Refresh"]}),h&&(0,d.jsxs)("button",{onClick:h,className:"px-3 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex items-center",children:[(0,d.jsx)(e._OO,{className:"h-4 w-4 mr-2"}),"Upload BOQ"]}),g&&(0,d.jsxs)("button",{onClick:g,className:"px-3 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex items-center",children:[(0,d.jsx)(e.FWt,{className:"h-4 w-4 mr-2"}),"Create BOQ"]})]})]})}},71423:(a,b,c)=>{c.d(b,{Q:()=>f});var d=c(49888);class e{async getAll(){try{let a=await fetch(this.baseUrl);if(!a.ok)throw Error(`Failed to fetch projects: ${a.statusText}`);return(await a.json()).projects||[]}catch(a){throw d.Rm.error("Error fetching projects:",a,"ProjectsService"),a}}async getById(a){try{let b=await fetch(`${this.baseUrl}/${a}`);if(!b.ok){if(404===b.status)return null;throw Error(`Failed to fetch project: ${b.statusText}`)}return(await b.json()).project}catch(a){throw d.Rm.error("Error fetching project by ID:",a,"ProjectsService"),a}}async create(a){try{let b=await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error(`Failed to create project: ${b.statusText}`);return(await b.json()).project}catch(a){throw d.Rm.error("Error creating project:",a,"ProjectsService"),a}}async update(a,b){try{let c=await fetch(`${this.baseUrl}/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error(`Failed to update project: ${c.statusText}`);return(await c.json()).project}catch(a){throw d.Rm.error("Error updating project:",a,"ProjectsService"),a}}async delete(a){try{let b=await fetch(`${this.baseUrl}/${a}`,{method:"DELETE"});if(!b.ok)throw Error(`Failed to delete project: ${b.statusText}`)}catch(a){throw d.Rm.error("Error deleting project:",a,"ProjectsService"),a}}async getByClient(a){try{let b=await fetch(`${this.baseUrl}?clientId=${a}`);if(!b.ok)throw Error(`Failed to fetch projects by client: ${b.statusText}`);return(await b.json()).projects||[]}catch(a){throw d.Rm.error("Error fetching projects by client:",a,"ProjectsService"),a}}async getStats(){try{let a=await fetch(`${this.baseUrl}/stats`);if(!a.ok)throw Error(`Failed to fetch project stats: ${a.statusText}`);return await a.json()}catch(a){throw d.Rm.error("Error fetching project stats:",a,"ProjectsService"),a}}async search(a){try{let b=await fetch(`${this.baseUrl}/search?q=${encodeURIComponent(a)}`);if(!b.ok)throw Error(`Failed to search projects: ${b.statusText}`);return(await b.json()).projects||[]}catch(a){throw d.Rm.error("Error searching projects:",a,"ProjectsService"),a}}constructor(){this.baseUrl="/api/projects"}}let f=new e},73106:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>h});var e=c(82015);c(82154);var f=c(86958);c(49888);var g=a([f]);function h(){let[a,b]=(0,e.useState)(null),[c,d]=(0,e.useState)(!0),[f,g]=(0,e.useState)(null);return{user:a,isLoading:c,isAuthenticated:!!a,error:f}}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},74075:a=>{a.exports=require("zlib")},74552:a=>{a.exports=require("pino")},82015:a=>{a.exports=require("react")},82154:(a,b,c)=>{c.d(b,{j2:()=>d});let d={currentUser:null,onAuthStateChanged:()=>()=>{},signOut:()=>Promise.resolve(),signInWithEmailAndPassword:()=>Promise.reject(Error("Use Clerk authentication")),createUserWithEmailAndPassword:()=>Promise.reject(Error("Use Clerk authentication"))}},86958:a=>{a.exports=import("firebase/auth")},87605:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>j,getServerSideProps:()=>k});var e=c(8732),f=c(82015),g=c(44233),h=c(88996),i=a([h]);function j({projectId:a,projectName:b,initialData:c=[]}){let d=(0,g.useRouter)(),[i,j]=(0,f.useState)(c),[k,l]=(0,f.useState)(!c.length);return(0,e.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,e.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,e.jsxs)("div",{className:"mb-8",children:[(0,e.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Bill of Quantities"}),b&&(0,e.jsxs)("p",{className:"mt-2 text-gray-600",children:["Project: ",b]})]}),k?(0,e.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,e.jsx)("div",{className:"text-gray-500",children:"Loading BOQ data..."})}):(0,e.jsx)(h.A,{onCreateBOQ:()=>{d.push("/procurement/boq/new")},className:"mt-6"})]})})}h=(i.then?(await i)():i)[0];let k=async a=>{let{query:b}=a,c=b.projectId,d=b.projectName;return{props:{projectId:c||null,projectName:d||null,initialData:[]}}};d()}catch(a){d(a)}})},88996:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>m});var e=c(8732),f=c(74952),g=c(94690),h=c(4202),i=c(69522),j=c(49262),k=c(15369),l=a([h]);function m({onSelectBOQ:a,onCreateBOQ:b,onUploadBOQ:c,selectedBOQId:d,className:l}){let{boqs:m,filteredAndSortedBOQs:n,filters:o,setFilters:p,isLoading:q,showFilters:r,setShowFilters:s,actionMenuOpen:t,setActionMenuOpen:u,filterOptions:v,loadBOQs:w,handleViewBOQ:x,handleEditBOQ:y,handleDownloadBOQ:z,handleArchiveBOQ:A,handleDeleteBOQ:B}=(0,h.C)(a);return q?(0,e.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,e.jsx)(f.krw,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,e.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading BOQs..."})]}):(0,e.jsxs)("div",{className:`space-y-6 ${l}`,children:[(0,e.jsx)(i.A,{totalBOQs:m.length,filteredCount:n.length,showFilters:r,setShowFilters:s,onCreateBOQ:b,onUploadBOQ:c,onRefresh:w}),r&&(0,e.jsx)(j.A,{filters:o,setFilters:p,uploaders:v.uploaders}),n.length>0?(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(a=>(0,e.jsx)(k.A,{boq:a,isSelected:d===a.id,onClick:()=>x(a),onView:()=>x(a),onEdit:()=>y(a),onDownload:()=>z(a),onArchive:()=>A(a),onDelete:()=>B(a),actionMenuOpen:t===a.id,setActionMenuOpen:b=>u(b?a.id:null)},a.id))}):(0,e.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border",children:[(0,e.jsx)(f.iUU,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,e.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No BOQs Found"}),(0,e.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:0===m.length?"No BOQs have been created for this project yet.":"No BOQs match your current filters."}),0===m.length&&(b||c)&&(0,e.jsxs)("div",{className:"mt-6 flex justify-center space-x-3",children:[b&&(0,e.jsx)("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700",children:"Create BOQ"}),c&&(0,e.jsx)("button",{onClick:c,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md text-sm font-medium hover:bg-gray-50",children:"Upload BOQ"})]}),Object.values(o).some(a=>""!==a&&"all"!==a)&&(0,e.jsx)("button",{onClick:()=>p(g.tV),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700",children:"Clear Filters"})]})]})}h=(l.then?(await l)():l)[0],d()}catch(a){d(a)}})},94690:(a,b,c)=>{c.d(b,{$b:()=>h,AA:()=>g,E:()=>e,NQ:()=>f,tV:()=>d});let d={search:"",status:"",mappingStatus:"",uploadedBy:"",dateRange:"all"},e={draft:"Draft",uploaded:"Uploaded",mapping:"Mapping",mapped:"Mapped",approved:"Approved",archived:"Archived"},f={draft:"bg-gray-100 text-gray-800",uploaded:"bg-blue-100 text-blue-800",mapping:"bg-yellow-100 text-yellow-800",mapped:"bg-green-100 text-green-800",approved:"bg-green-100 text-green-800",archived:"bg-gray-100 text-gray-800",mapping_review:"bg-orange-100 text-orange-800"},g={pending:"Pending",in_progress:"In Progress",mapped:"Mapped",exception:"Exception"},h={pending:"bg-gray-100 text-gray-800",in_progress:"bg-yellow-100 text-yellow-800",mapped:"bg-green-100 text-green-800",exception:"bg-red-100 text-red-800",completed:"bg-green-100 text-green-800"}}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,2341,5781,4233,363],()=>b(b.s=46200));module.exports=c})();