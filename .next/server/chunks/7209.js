"use strict";exports.id=7209,exports.ids=[7209],exports.modules={7209:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{UnifiedTrackerGrid:()=>o});var e=c(8732),f=c(82015),g=c(44233),h=c(74952),i=c(80638),j=c(11215),k=c(72271),l=c(14843),m=c(94664),n=a([j]);function o(){let{projectId:a}=(0,g.useRouter)().query,[b,c]=(0,f.useState)(""),[d,n]=(0,f.useState)("all"),[o,p]=(0,f.useState)("all"),[q,r]=(0,f.useState)("all"),[s,t]=(0,f.useState)("identifier"),[u,v]=(0,f.useState)("asc"),[w,x]=(0,f.useState)(new Set),{data:y,isLoading:z,refetch:A}=(0,j.M)("string"==typeof a?a:""),B=(0,f.useMemo)(()=>{if(!y)return[];let a=[...y];return b&&(a=a.filter(a=>a.identifier.toLowerCase().includes(b.toLowerCase())||a.location.toLowerCase().includes(b.toLowerCase()))),"all"!==d&&(a=a.filter(a=>a.type===d)),"all"!==o&&(a=a.filter(a=>a.phase===o)),"all"!==q&&(a=a.filter(a=>a.status===q)),a.sort((a,b)=>{let c,d;return("updated"===s?(c=a.lastUpdated?a.lastUpdated.getTime():0,d=b.lastUpdated?b.lastUpdated.getTime():0):"identifier"===s?(c=a.identifier,d=b.identifier):"status"===s?(c=a.status,d=b.status):"progress"===s?(c=a.progress,d=b.progress):(c=0,d=0),"asc"===u)?c>d?1:-1:c<d?1:-1}),a},[y,b,d,o,q,s,u]),C=(0,f.useMemo)(()=>{if(!y)return[];let a=new Set(y.map(a=>a.phase).filter(Boolean));return Array.from(a).sort()},[y]),D=(0,f.useMemo)(()=>{if(!y)return null;let a=y.filter(a=>"pole"===a.type),b=y.filter(a=>"drop"===a.type),c=y.filter(a=>"fiber"===a.type);return{poles:{total:a.length,completed:a.filter(a=>"completed"===a.status).length,progress:a.filter(a=>"in_progress"===a.status).length,pending:a.filter(a=>"pending"===a.status).length},drops:{total:b.length,completed:b.filter(a=>"completed"===a.status).length,progress:b.filter(a=>"in_progress"===a.status).length,pending:b.filter(a=>"pending"===a.status).length},fiber:{total:c.length,completed:c.filter(a=>"completed"===a.status).length,progress:c.filter(a=>"in_progress"===a.status).length,pending:c.filter(a=>"pending"===a.status).length}}},[y]);return(0,e.jsxs)("div",{className:"p-6 space-y-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsxs)("div",{children:[(0,e.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,e.jsx)(h.pRo,{className:"w-6 h-6"}),"Unified Tracker Grid"]}),(0,e.jsx)("p",{className:"text-gray-600 mt-1",children:"Track all poles, drops, and fiber sections in one place"})]}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsxs)("button",{onClick:()=>A(),className:"px-4 py-2 border rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[(0,e.jsx)(h.e9t,{className:"w-4 h-4"}),"Refresh"]}),(0,e.jsxs)("button",{onClick:()=>{let a=[["Type","Identifier","Location","Phase","Status","Progress","Photos","Quality Checks","Last Updated"],...B.map(a=>[a.type,a.identifier,a.location,a.phase,a.status,`${a.progress}%`,`${a.photos}/${a.totalPhotos}`,`${a.qualityChecks}/${a.totalChecks}`,a.lastUpdated?(0,i.format)(a.lastUpdated,"yyyy-MM-dd HH:mm"):"N/A"])].map(a=>a.join(",")).join("\n"),b=new Blob([a],{type:"text/csv"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`tracker-export-${(0,i.format)(new Date,"yyyy-MM-dd")}.csv`,d.click()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[(0,e.jsx)(h.f5X,{className:"w-4 h-4"}),"Export"]})]})]}),(0,e.jsx)(k.a,{stats:D}),(0,e.jsx)(l.o,{searchTerm:b,setSearchTerm:c,selectedType:d,setSelectedType:n,selectedPhase:o,setSelectedPhase:p,selectedStatus:q,setSelectedStatus:r,sortBy:s,sortOrder:u,setSortBy:t,setSortOrder:v,phases:C}),(0,e.jsx)(m.Z,{data:B,isLoading:z,expandedRows:w,toggleRowExpansion:a=>{let b=new Set(w);b.has(a)?b.delete(a):b.add(a),x(b)}})]})}j=(n.then?(await n)():n)[0],d()}catch(a){d(a)}})},11215:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{M:()=>i});var e=c(28462),f=c(44337),g=c(78121),h=a([e,f,g]);function i(a){return(0,e.useQuery)({queryKey:["unified-trackers",a],queryFn:async()=>{if(!a)return[];let b=[],c=(0,f.query)((0,f.collection)(g.db,"poles"),(0,f.where)("projectId","==",a),(0,f.orderBy)("poleNumber"));(await (0,f.getDocs)(c)).forEach(a=>{let c=a.data(),d=Object.values(c.photos||{}).filter(Boolean).length,e=Object.values(c.qualityChecks||{}).filter(a=>null!==a).length,f={id:a.id,type:"pole",identifier:c.poleNumber,vfId:c.vfPoleId||`P-${a.id}`,projectName:c.projectName||"",location:c.location||"Not specified",phase:c.phase||"Phase 1",status:c.status||"pending",progress:j(c),hasPhotos:d>0,lastUpdated:c.metadata?.lastUpdated?.toDate()||new Date,photos:d,totalPhotos:6,qualityChecks:e,totalChecks:8,metadata:c};b.push(f)});let d=(0,f.query)((0,f.collection)(g.db,"drops"),(0,f.where)("projectId","==",a),(0,f.orderBy)("dropNumber"));(await (0,f.getDocs)(d)).forEach(a=>{let c=a.data(),d=Object.values(c.photos||{}).filter(Boolean).length,e=Object.values(c.qualityChecks||{}).filter(a=>null!==a).length,f={id:a.id,type:"drop",identifier:c.dropNumber,vfId:c.vfDropId||`D-${a.id}`,projectName:c.projectName||"",location:c.address||"Not specified",phase:c.phase||"Phase 1",status:c.status||"pending",progress:j(c),hasPhotos:d>0,lastUpdated:c.metadata?.lastUpdated?.toDate()||new Date,photos:d,totalPhotos:6,qualityChecks:e,totalChecks:6,metadata:c};b.push(f)});let e=(0,f.query)((0,f.collection)(g.db,"fiberSections"),(0,f.where)("projectId","==",a),(0,f.orderBy)("sectionId"));return(await (0,f.getDocs)(e)).forEach(a=>{let c=a.data(),d=Object.values(c.photos||{}).filter(Boolean).length,e=Object.values(c.qualityChecks||{}).filter(a=>null!==a).length,f={id:a.id,type:"fiber",identifier:c.sectionId,vfId:c.vfFiberId||`F-${a.id}`,projectName:c.projectName||"",location:`${c.startPoint||"Start"} â†’ ${c.endPoint||"End"}`,phase:c.phase||"Phase 1",status:c.status||"pending",progress:j(c),hasPhotos:d>0,lastUpdated:c.metadata?.lastUpdated?.toDate()||new Date,photos:d,totalPhotos:6,qualityChecks:e,totalChecks:6,metadata:c};b.push(f)}),b},enabled:!!a})}function j(a){let b=0,c=0;if(a.photos){let d=Object.values(a.photos);b+=d.length,c+=d.filter(Boolean).length}if(a.qualityChecks){let d=Object.values(a.qualityChecks);b+=d.length,c+=d.filter(a=>null!==a).length}return b+=1,"completed"===a.status&&(c+=1),b>0?Math.round(c/b*100):0}[e,f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},14843:(a,b,c)=>{c.d(b,{o:()=>f});var d=c(8732),e=c(74952);function f({searchTerm:a,setSearchTerm:b,selectedType:c,setSelectedType:f,selectedPhase:g,setSelectedPhase:h,selectedStatus:i,setSelectedStatus:j,sortBy:k,sortOrder:l,setSortBy:m,setSortOrder:n,phases:o}){return(0,d.jsx)("div",{className:"bg-white p-4 rounded-lg border space-y-4",children:(0,d.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,d.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(e.vji,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,d.jsx)("input",{type:"text",placeholder:"Search by ID or location...",value:a,onChange:a=>b(a.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(0,d.jsxs)("select",{value:c,onChange:a=>f(a.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"all",children:"All Types"}),(0,d.jsx)("option",{value:"pole",children:"Poles"}),(0,d.jsx)("option",{value:"drop",children:"Home Drops"}),(0,d.jsx)("option",{value:"fiber",children:"Fiber Sections"})]}),(0,d.jsxs)("select",{value:g,onChange:a=>h(a.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"all",children:"All Phases"}),o.map(a=>(0,d.jsx)("option",{value:a,children:a},a))]}),(0,d.jsxs)("select",{value:i,onChange:a=>j(a.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"all",children:"All Status"}),(0,d.jsx)("option",{value:"pending",children:"Pending"}),(0,d.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,d.jsx)("option",{value:"completed",children:"Completed"}),(0,d.jsx)("option",{value:"issue",children:"Issue"})]}),(0,d.jsxs)("select",{value:`${k}-${l}`,onChange:a=>{let[b,c]=a.target.value.split("-");m(b),n(c)},className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"identifier-asc",children:"ID (A-Z)"}),(0,d.jsx)("option",{value:"identifier-desc",children:"ID (Z-A)"}),(0,d.jsx)("option",{value:"status-asc",children:"Status (A-Z)"}),(0,d.jsx)("option",{value:"status-desc",children:"Status (Z-A)"}),(0,d.jsx)("option",{value:"progress-asc",children:"Progress (Low-High)"}),(0,d.jsx)("option",{value:"progress-desc",children:"Progress (High-Low)"}),(0,d.jsx)("option",{value:"updated-desc",children:"Recently Updated"}),(0,d.jsx)("option",{value:"updated-asc",children:"Oldest Updated"})]})]})})}},72271:(a,b,c)=>{c.d(b,{a:()=>f});var d=c(8732),e=c(74952);function f({stats:a}){return a?(0,d.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Poles"}),(0,d.jsx)(e.sDd,{className:"w-4 h-4 text-gray-400"})]}),(0,d.jsx)("div",{className:"text-2xl font-bold",children:a.poles.total}),(0,d.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[a.poles.completed," completed, ",a.poles.progress," in progress"]})]}),(0,d.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Home Drops"}),(0,d.jsx)(e.ww0,{className:"w-4 h-4 text-gray-400"})]}),(0,d.jsx)("div",{className:"text-2xl font-bold",children:a.drops.total}),(0,d.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[a.drops.completed," completed, ",a.drops.progress," in progress"]})]}),(0,d.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Fiber Sections"}),(0,d.jsx)(e.A8q,{className:"w-4 h-4 text-gray-400"})]}),(0,d.jsx)("div",{className:"text-2xl font-bold",children:a.fiber.total}),(0,d.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[a.fiber.completed," completed, ",a.fiber.progress," in progress"]})]})]}):null}},78121:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{db:()=>l});var e=c(66551),f=c(86958),g=c(44337),h=c(82537),i=a([e,f,g,h]);[e,f,g,h]=i.then?(await i)():i;let j={apiKey:process.env.NEXT_PUBLIC_FIREBASE_API_KEY||"AIzaSyDvW-ImXptnYIX7IDR78pdruw9BAp5A8Q8",authDomain:process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"fibreflow-292c7.firebaseapp.com",projectId:process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"fibreflow-292c7",storageBucket:process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||"fibreflow-292c7.firebasestorage.app",messagingSenderId:process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID||"178707510767",appId:process.env.NEXT_PUBLIC_FIREBASE_APP_ID||"1:178707510767:web:a9455c8f053de03fbff21a",measurementId:process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID||"G-3S74XHZ49B"},k=0===(0,e.getApps)().length?(0,e.initializeApp)(j):(0,e.getApp)();(0,f.getAuth)(k);let l=(0,g.getFirestore)(k);(0,h.getStorage)(k),d()}catch(a){d(a)}})},94664:(a,b,c)=>{c.d(b,{Z:()=>i});var d=c(8732),e=c(82015),f=c.n(e),g=c(74952),h=c(80638);function i({data:a,isLoading:b,expandedRows:c,toggleRowExpansion:e}){return(0,d.jsx)("div",{className:"bg-white rounded-lg border overflow-hidden",children:(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"w-full",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{className:"bg-gray-50 border-b",children:[(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Identifier"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Location"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phase"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Progress"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Photos"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"QC"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Updated"}),(0,d.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),(0,d.jsx)("tbody",{children:b?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:10,className:"px-4 py-8 text-center text-gray-500",children:"Loading tracker data..."})}):0===a.length?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:10,className:"px-4 py-8 text-center text-gray-500",children:"No items found matching your filters"})}):a.map(a=>(0,d.jsxs)(f().Fragment,{children:[(0,d.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(a=>{switch(a){case"pole":return(0,d.jsx)(g.sDd,{className:"w-4 h-4"});case"drop":return(0,d.jsx)(g.ww0,{className:"w-4 h-4"});case"fiber":return(0,d.jsx)(g.A8q,{className:"w-4 h-4"});default:return null}})(a.type),(0,d.jsx)("span",{className:"text-xs font-medium uppercase text-gray-600",children:a.type})]})}),(0,d.jsx)("td",{className:"px-4 py-3 font-medium",children:a.identifier}),(0,d.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:a.location}),(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsx)("span",{className:"text-xs font-medium text-gray-600",children:a.phase})}),(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(a=>{switch(a){case"completed":return"text-green-600 bg-green-50";case"in_progress":return"text-blue-600 bg-blue-50";case"issue":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}})(a.status)}`,children:a.status})}),(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,d.jsx)("div",{className:`h-2 rounded-full ${100===a.progress?"bg-green-500":a.progress>=50?"bg-blue-500":"bg-yellow-500"}`,style:{width:`${a.progress}%`}})}),(0,d.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:[a.progress,"%"]})]})}),(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(g.i7d,{className:"w-4 h-4 text-gray-400"}),(0,d.jsxs)("span",{className:"text-sm",children:[a.photos,"/",a.totalPhotos]})]})}),(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[a.qualityChecks===a.totalChecks?(0,d.jsx)(g.rAV,{className:"w-4 h-4 text-green-500"}):(0,d.jsx)(g.hcu,{className:"w-4 h-4 text-yellow-500"}),(0,d.jsxs)("span",{className:"text-sm",children:[a.qualityChecks,"/",a.totalChecks]})]})}),(0,d.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:a.lastUpdated?(0,h.format)(a.lastUpdated,"MMM dd, HH:mm"):"N/A"}),(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsx)("button",{onClick:()=>e(a.id),className:"p-1 hover:bg-gray-100 rounded",children:c.has(a.id)?(0,d.jsx)(g.rXn,{className:"w-4 h-4"}):(0,d.jsx)(g.yQN,{className:"w-4 h-4"})})})]}),c.has(a.id)&&(0,d.jsx)("tr",{className:"bg-gray-50",children:(0,d.jsx)("td",{colSpan:10,className:"px-8 py-4",children:(0,d.jsx)(j,{item:a})})})]},a.id))})]})})})}function j({item:a}){return(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-medium mb-2",children:"Details"}),(0,d.jsxs)("dl",{className:"space-y-1",children:["pole"===a.type&&(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("dt",{className:"text-gray-600",children:"Drop Count:"}),(0,d.jsxs)("dd",{className:"font-medium",children:[a.metadata?.dropCount||0,"/12"]})]}),"drop"===a.type&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("dt",{className:"text-gray-600",children:"Pole Number:"}),(0,d.jsx)("dd",{className:"font-medium",children:a.metadata?.poleNumber||"N/A"})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("dt",{className:"text-gray-600",children:"Home Owner:"}),(0,d.jsx)("dd",{className:"font-medium",children:a.metadata?.homeOwner||"N/A"})]})]}),"fiber"===a.type&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("dt",{className:"text-gray-600",children:"Length:"}),(0,d.jsxs)("dd",{className:"font-medium",children:[a.metadata?.length||0,"m"]})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("dt",{className:"text-gray-600",children:"Cable Type:"}),(0,d.jsx)("dd",{className:"font-medium",children:a.metadata?.cableType||"N/A"})]})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-medium mb-2",children:"Actions"}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("button",{className:"w-full px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600",children:"View Details"}),(0,d.jsx)("button",{className:"w-full px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"Update Status"})]})]})]})}}};