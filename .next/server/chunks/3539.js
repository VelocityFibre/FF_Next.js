"use strict";exports.id=3539,exports.ids=[3539],exports.modules={383:(a,b,c)=>{c.d(b,{A0:()=>f,_U:()=>e});var d=c(34633);function e(a){if(a){if(a instanceof Date)return a;if("number"==typeof a)return new Date(new Date(1900,0,1).getTime()+(a-2)*864e5);if("string"==typeof a){let b=a.match(/^(\d{4})\/(\d{1,2})\/(\d{1,2})$/);if(b){let[,a,c,d]=b;return new Date(parseInt(a),parseInt(c)-1,parseInt(d))}let c=a.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(c){let[,a,b,d]=c;return new Date(parseInt(d),parseInt(b)-1,parseInt(a))}let d=a.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(d){let[,a,b,c]=d;return new Date(parseInt(a),parseInt(b)-1,parseInt(c))}let e=new Date(a);if(!isNaN(e.getTime()))return e}}}function f(a){if(!a)return[];let b=[];for(let c of a.split(",").map(a=>a.trim()))if(c){let a=Object.values(d.ef).find(a=>a.toLowerCase().replace(/_/g," ")===c.toLowerCase()||a.toLowerCase()===c.toLowerCase());a&&b.push(a)}return b}},4816:(a,b,c)=>{c.d(b,{XB:()=>f,dP:()=>e,s2:()=>g});var d=c(49888);async function e(a){try{let{staffNeonService:b}=await c.e(3970).then(c.bind(c,23970)),d=await b.getAll(),e=d.find(b=>b.name.toLowerCase().trim()===a.toLowerCase().trim());if(e&&e.id)return e.id;let f=d.find(b=>b.name.toLowerCase().includes(a.toLowerCase().trim())||a.toLowerCase().includes(b.name.toLowerCase().trim()));if(f&&f.id)return f.id;return null}catch(a){return d.Rm.error("Error looking up manager by name:",{data:a},"managerResolver"),null}}function f(a){let b=new Set;return a.forEach(a=>{a.managerName&&a.managerName.trim()&&b.add(a.managerName.trim())}),b}function g(a,b){return[...a].sort((a,c)=>{let d=b.has(a.name?.trim()||""),e=b.has(c.name?.trim()||"");return d&&!e?-1:!d&&e?1:0})}},8051:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{r:()=>j});var e=c(79441),f=c(90818),g=c(53984);c(383),c(4816);var h=c(25773),i=a([e,f,h]);[e,f,h]=i.then?(await i)():i;let j={importFromCSV:e.u,importFromExcel:f.p,exportToExcel:f.b,getImportTemplate:()=>g.J.join(",")};d()}catch(a){d(a)}})},25773:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{g:()=>j});var e=c(43294),f=c(4816),g=c(383),h=c(49888),i=a([e]);async function j(a,b=!0){let{staffService:d}=await Promise.all([c.e(3970),c.e(2771)]).then(c.bind(c,32771)),i=[],k=[],l=0,m=0,n=(0,f.XB)(a);h.Rm.info("\uD83D\uDCCA Unique managers found:",{data:Array.from(n)},"rowProcessor");let o=(0,f.s2)(a,n);for(let b=0;b<o.length;b++){let c=o[b],j=a.indexOf(c)+2;try{let a;if(!c.name||""===c.name.trim()){i.push({row:j,field:"name",message:"Name is required"}),m++;continue}if(!c.email||""===c.email.trim()){i.push({row:j,field:"email",message:"Email is required"}),m++;continue}if(!c.phone||""===c.phone.trim()){i.push({row:j,field:"phone",message:"Phone is required"}),m++;continue}if(!c.employeeId||""===c.employeeId.trim()){h.Rm.info(`Row ${j} missing employeeId. Available fields:`,{data:Object.keys(c)},"rowProcessor"),i.push({row:j,field:"employeeId",message:"Employee ID is required"}),m++;continue}if(c.managerName&&c.managerName.trim()&&""!==c.managerName.trim()){let b=c.managerName.trim();try{let c=await (0,f.dP)(b);c&&(a=c)}catch(a){}}let n=c.employeeId&&""!==c.employeeId.trim()?c.employeeId.trim():`AUTO_${Date.now()}_${b}`;h.Rm.info("Manager lookup result:",{data:{managerName:c.managerName,resolvedUuid:a,reportsToType:typeof a,reportsToValue:JSON.stringify(a)}},"rowProcessor");let o=new Date;if(c.startDate){let a=(0,g._U)(c.startDate);a&&(o=a)}let p={name:c.name.trim(),email:c.email.trim(),phone:c.phone.trim()||"",...c.alternativePhone&&{alternativePhone:c.alternativePhone},employeeId:n,position:c.position||"Staff",department:c.department||"Operations",contractType:e.h$.PERMANENT,status:e.fo.ACTIVE,...a&&{reportsTo:a},startDate:o,address:c.address||"",city:c.city||"",province:c.province||"",postalCode:c.postalCode||"",...c.emergencyContactName&&{emergencyContactName:c.emergencyContactName},...c.emergencyContactPhone&&{emergencyContactPhone:c.emergencyContactPhone},experienceYears:0,workingHours:"9:00-17:00",availableWeekends:!1,availableNights:!1,timeZone:"Africa/Johannesburg",maxProjectCount:5,skills:(0,g.A0)(c.skills)};h.Rm.info(`ðŸ“ Creating or updating staff member: ${p.name} (Employee ID: ${p.employeeId}, undefined, 'rowProcessor');`);let q=await d.createOrUpdate(p);q?(k.push(q),l++):(m++,i.push({row:j,field:"",message:"Failed to create/update staff member"}))}catch(a){h.Rm.error(`âŒ Error processing row ${j}:`,{data:a},"rowProcessor"),m++,i.push({row:j,field:"",message:a instanceof Error?a.message:"Unknown error occurred"})}}return{success:0===m,total:a.length,imported:l,failed:m,errors:i,staffMembers:k}}e=(i.then?(await i)():i)[0],d()}catch(a){d(a)}})},34633:(a,b,c)=>{c.d(b,{Lz:()=>d,ef:()=>g,fo:()=>e,h$:()=>f});var d=function(a){return a.INTERN="intern",a.JUNIOR="junior",a.INTERMEDIATE="intermediate",a.SENIOR="senior",a.LEAD="lead",a.MANAGER="manager",a.SENIOR_MANAGER="senior_manager",a.DIRECTOR="director",a.EXECUTIVE="executive",a}({}),e=function(a){return a.ACTIVE="active",a.INACTIVE="inactive",a.ON_LEAVE="on_leave",a.SUSPENDED="suspended",a.TERMINATED="terminated",a.RESIGNED="resigned",a.RETIRED="retired",a}({}),f=function(a){return a.PERMANENT="permanent",a.CONTRACT="contract",a.TEMPORARY="temporary",a.FREELANCE="freelance",a.INTERN="intern",a.CONSULTANT="consultant",a}({}),g=function(a){return a.FIBRE_SPLICING="fibre_splicing",a.OTDR_TESTING="otdr_testing",a.POWER_METER_TESTING="power_meter_testing",a.CABLE_INSTALLATION="cable_installation",a.POLE_INSTALLATION="pole_installation",a.TRENCHING="trenching",a.DUCT_INSTALLATION="duct_installation",a.NETWORK_DESIGN="network_design",a.NETWORK_CONFIGURATION="network_configuration",a.TROUBLESHOOTING="troubleshooting",a.MAINTENANCE="maintenance",a.PROJECT_MANAGEMENT="project_management",a.TEAM_LEADERSHIP="team_leadership",a.PLANNING="planning",a.COORDINATION="coordination",a.SAFETY_PROTOCOLS="safety_protocols",a.QUALITY_CONTROL="quality_control",a.COMPLIANCE="compliance",a.CUSTOMER_RELATIONS="customer_relations",a.COMMUNICATION="communication",a.PROBLEM_SOLVING="problem_solving",a}({})},43294:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Lz:()=>e.Lz,ef:()=>e.ef,fo:()=>e.fo,h$:()=>e.h$});var e=c(58742),f=c(44337),g=a([f]);f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},53984:(a,b,c)=>{c.d(b,{J:()=>e,d:()=>d});let d={name:"name",Name:"name",email:"email",Email:"email",phone:"phone",Phone:"phone","employee id":"employeeId","Employee ID":"employeeId",position:"position",Position:"position",department:"department",Department:"department","department ":"department","Primary Group":"department","reports to":"managerName","reports to ":"managerName","Reports To":"managerName",Level:"level",Status:"status",Skills:"skills",address:"address",Address:"address",city:"city",City:"city",province:"province",Province:"province",postalCode:"postalCode","Postal Code":"postalCode","Emergency Contact Name":"emergencyContactName","Emergency Contact Phone":"emergencyContactPhone","start date":"startDate","Start Date":"startDate","Contract Type":"contractType","Working Hours":"workingHours","Alternative Phone":"alternativePhone"},e=["employee id","name","email","phone","position","department","reports to","address","city","province","postalCode","start date"]},58326:(a,b,c)=>{c.d(b,{xi:()=>d});function d(a){try{if(!a)return new Date;if("object"==typeof a&&"toDate"in a&&"function"==typeof a.toDate)return a.toDate();if("string"==typeof a){let b=new Date(a);if(!isNaN(b.getTime()))return b;return new Date}if(a instanceof Date){if(!isNaN(a.getTime()))return a;return new Date}if("number"==typeof a){let b=new Date(a);if(!isNaN(b.getTime()))return b}return new Date}catch(a){return new Date}}},58742:(a,b,c)=>{c.d(b,{h$:()=>d.h$,ef:()=>d.ef,Lz:()=>d.Lz,fo:()=>d.fo});var d=c(34633)},63539:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{r:()=>e.r});var e=c(8051),f=a([e]);e=(f.then?(await f)():f)[0],d()}catch(a){d(a)}})},79441:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{u:()=>i});var e=c(53984),f=c(25773),g=c(49888),h=a([f]);async function i(a,b=!0){return new Promise((c,d)=>{let h=new FileReader;h.onload=async a=>{try{let d=(a.target?.result).split("\n").filter(a=>a.trim()),h=d[0].split(",").map(a=>a.trim());g.Rm.info("Header mapping will be:",{data:h.map(a=>`${a} -> ${e.d[a]||"unmapped"}`)},"csvProcessor");let i=[];for(let a=1;a<d.length;a++){let b=d[a].split(",").map(a=>a.trim()),c={};h.forEach((a,d)=>{c[e.d[a]||a.toLowerCase().replace(/\s+/g,"")]=b[d]||""}),i.push(c)}let j=await (0,f.g)(i,b);c(j)}catch(a){d(a)}},h.onerror=()=>d(Error("Failed to read CSV file")),h.readAsText(a)})}f=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})},90818:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{b:()=>j,p:()=>i});var e=c(15751),f=c(25773),g=c(58326),h=a([f]);async function i(a,b=!0){return new Promise((c,d)=>{let g=new FileReader;g.onload=async a=>{try{let d=a.target?.result,g=e.read(d,{type:"binary"}),h=g.SheetNames[0],i=g.Sheets[h],j=e.utils.sheet_to_json(i,{raw:!1,dateNF:"yyyy/mm/dd"}).map(a=>({employeeId:a["Employee ID"]||a["employee id"]||"",name:a.Name||a.name||"",email:a.Email||a.email||"",phone:a.Phone||a.phone||"",position:a.Position||a.position||"Staff",department:a.Department||a.department||a["Primary Group"]||"Operations",managerName:a["Reports To"]||a["reports to"]||"",skills:a.Skills||a.skills||"",alternativePhone:a["Alternative Phone"]||a["alternative phone"]||"",address:a.Address||a.address||"",city:a.City||a.city||"",province:a.Province||a.province||"",postalCode:a["Postal Code"]||a["postal code"]||"",emergencyContactName:a["Emergency Contact Name"]||"",emergencyContactPhone:a["Emergency Contact Phone"]||"",startDate:a["Start Date"]||a["start date"]||"",contractType:a["Contract Type"]||"",workingHours:a["Working Hours"]||""})),k=await (0,f.g)(j,b);c(k)}catch(a){d(a)}},g.onerror=()=>d(Error("Failed to read Excel file")),g.readAsBinaryString(a)})}function j(a){let b=a.map(a=>({"Employee ID":a.employeeId||"",Name:a.name,Email:a.email,Phone:a.phone,Position:a.position||"",Department:a.department||"",Status:a.status,"Start Date":a.startDate?(0,g.xi)(a.startDate).toLocaleDateString():"",Manager:a.managerName||"","Alternative Phone":a.alternativePhone||"","Contract Type":a.contractType||""})),c=e.utils.json_to_sheet(b),d=e.utils.book_new();e.utils.book_append_sheet(d,c,"Staff");let f=`staff_export_${new Date().toISOString().split("T")[0]}.xlsx`;e.writeFile(d,f)}f=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})}};