"use strict";exports.id=1467,exports.ids=[1467],exports.modules={2663:(a,b,c)=>{c.d(b,{Ai:()=>e,KB:()=>g,Ks:()=>f,bd:()=>d});var d=function(a){return a.POLES="poles",a.DROPS="drops",a.CABLE="cable",a.TRENCH="trench",a.OTHER="other",a.PROPOSAL="proposal",a.CONTRACT="contract",a.SOW="sow",a.TECHNICAL_SPEC="technical_spec",a.BUDGET="budget",a.SCHEDULE="schedule",a.REPORT="report",a.FIBRE="fibre",a.GENERAL="general",a.SITE_SURVEY="site_survey",a.TECHNICAL_SPECS="technical_specs",a.EQUIPMENT="equipment",a}({}),e=function(a){return a.PENDING="pending",a.APPROVED="approved",a.REJECTED="rejected",a.NEEDS_REVIEW="needs_review",a}({}),f=function(a){return a.PLANNING="planning",a.ACTIVE="active",a.ON_HOLD="on_hold",a.COMPLETED="completed",a.CANCELLED="cancelled",a}({}),g=function(a){return a.LOW="low",a.MEDIUM="medium",a.HIGH="high",a.CRITICAL="critical",a}({})},2934:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{l:()=>i});var e=c(8732),f=c(74281),g=c(77020),h=a([g]);function i({currentStep:a}){return(0,e.jsxs)("div",{className:"mb-8",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Create New Project"}),(0,e.jsx)("div",{className:"flex items-center justify-between mb-6",children:f.b.map((b,c)=>{let d=c===a,h=c<a,i=b.icon;return(0,e.jsxs)("div",{className:"flex items-center flex-1",children:[(0,e.jsxs)("div",{className:"flex flex-col items-center",children:[(0,e.jsx)("div",{className:(0,g.cn)("w-10 h-10 rounded-full flex items-center justify-center mb-2",d?"bg-blue-600 text-white":h?"bg-green-600 text-white":"bg-gray-200 text-gray-600"),children:(0,e.jsx)(i,{size:20})}),(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("p",{className:(0,g.cn)("text-sm font-medium",d?"text-blue-600":h?"text-green-600":"text-gray-500"),children:b.title}),(0,e.jsx)("p",{className:"text-xs text-gray-500 hidden sm:block",children:b.description})]})]}),c<f.b.length-1&&(0,e.jsx)("div",{className:(0,g.cn)("flex-1 h-px mx-4 mt-5",h?"bg-green-600":"bg-gray-200")})]},b.id)})})]})}g=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})},15855:(a,b,c)=>{c.d(b,{u:()=>h});var d=c(8732),e=c(19918),f=c.n(e),g=c(2663);function h({form:a,projectManagers:b,isProjectManagersLoading:c}){let{register:e,formState:{errors:h}}=a;return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget (R)"}),(0,d.jsx)("input",{...e("budget.totalBudget",{min:{value:0,message:"Budget must be positive"},valueAsNumber:!0}),type:"number",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"}),h.budget?.totalBudget&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.budget.totalBudget.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority *"}),(0,d.jsxs)("select",{...e("priority",{required:"Priority is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:g.KB.LOW,children:"Low"}),(0,d.jsx)("option",{value:g.KB.MEDIUM,children:"Medium"}),(0,d.jsx)("option",{value:g.KB.HIGH,children:"High"}),(0,d.jsx)("option",{value:g.KB.CRITICAL,children:"Critical"})]}),h.priority&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.priority.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,d.jsxs)("select",{...e("status"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:g.Ks.PLANNING,children:"Planning"}),(0,d.jsx)("option",{value:g.Ks.ACTIVE,children:"Active"}),(0,d.jsx)("option",{value:g.Ks.ON_HOLD,children:"On Hold"}),(0,d.jsx)("option",{value:g.Ks.COMPLETED,children:"Completed"}),(0,d.jsx)("option",{value:g.Ks.CANCELLED,children:"Cancelled"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Project Manager *"}),(0,d.jsx)(f(),{href:"/staff",target:"_blank",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Manage Staff →"})]}),c?(0,d.jsx)("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50",children:"Loading project managers..."}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("select",{...e("projectManagerId",{required:"Project Manager is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"",children:"Select project manager"}),b?.map(a=>(0,d.jsx)("option",{value:a.id,children:a.name},a.id))]}),0===b.length&&(0,d.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["No project managers available.",(0,d.jsx)(f(),{href:"/staff/new",target:"_blank",className:"ml-1 text-blue-600 hover:text-blue-800 hover:underline",children:"Add a staff member"})]})]}),h.projectManagerId&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.projectManagerId.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Members"}),(0,d.jsx)("div",{className:"text-sm text-gray-500",children:"Team members can be assigned after project creation"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,d.jsx)("textarea",{...e("description"),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Additional notes or requirements"})]})]})}},43541:(a,b,c)=>{c.d(b,{I:()=>g});var d=c(8732),e=c(74952),f=c(74281);function g({currentStep:a,onPrevious:b,onNext:c,onSubmit:g,isSubmitting:h,isLastStep:i}){return(0,d.jsxs)("div",{className:"flex justify-between items-center pt-6 border-t border-gray-200",children:[(0,d.jsxs)("button",{type:"button",onClick:b,disabled:0===a,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,d.jsx)(e.nkM,{size:16,className:"mr-2"}),"Previous"]}),(0,d.jsxs)("div",{className:"text-sm text-gray-500",children:["Step ",a+1," of ",f.b.length]}),i?(0,d.jsx)("button",{type:"button",onClick:g,disabled:h,className:"flex items-center px-6 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:h?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.krw,{size:16,className:"mr-2 animate-spin"}),"Creating Project..."]}):"Create Project"}):(0,d.jsxs)("button",{type:"button",onClick:c,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:["Next",(0,d.jsx)(e.Qpb,{size:16,className:"ml-2"})]})]})}},46392:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Ak:()=>i,LC:()=>k,_P:()=>l,_c:()=>m,tH:()=>j}),c(82015);var e=c(28462),f=c(4238),g=c(49888),h=a([e,f]);[e,f]=h.then?(await h)():h;let n={all:["clients"],lists:()=>[...n.all,"list"],list:a=>[...n.lists(),{filter:a}],details:()=>[...n.all,"detail"],detail:a=>[...n.details(),a],active:()=>[...n.all,"active"],summary:()=>[...n.all,"summary"],contactHistory:a=>[...n.all,"contactHistory",a]};function i(){return(0,e.useQuery)({queryKey:n.active(),queryFn:()=>f.L.getActiveClients(),staleTime:6e5})}function j(a){return(0,e.useQuery)({queryKey:n.detail(a),queryFn:()=>f.L.getById(a),enabled:!!a})}function k(){let a=(0,e.useQueryClient)();return(0,e.useMutation)({mutationFn:a=>f.L.create(a),onSuccess:()=>{a.invalidateQueries({queryKey:n.all})},onError:a=>{throw g.Rm.error("Failed to create client:",{data:a},"useClients"),a}})}function l(){let a=(0,e.useQueryClient)();return(0,e.useMutation)({mutationFn:({id:a,data:b})=>f.L.update(a,b),onSuccess:(b,{id:c})=>{a.invalidateQueries({queryKey:n.detail(c)}),a.invalidateQueries({queryKey:n.lists()}),a.invalidateQueries({queryKey:n.active()}),a.invalidateQueries({queryKey:n.summary()})},onError:a=>{throw g.Rm.error("Failed to update client:",{data:a},"useClients"),a}})}function m(){let a=(0,e.useQueryClient)();return(0,e.useMutation)({mutationFn:a=>f.L.delete(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:n.detail(c)}),a.invalidateQueries({queryKey:n.lists()}),a.invalidateQueries({queryKey:n.active()}),a.invalidateQueries({queryKey:n.summary()})},onError:a=>{throw g.Rm.error("Failed to delete client:",{data:a},"useClients"),a}})}d()}catch(a){d(a)}})},47077:(a,b,c)=>{c.d(b,{B:()=>m});var d=c(8732),e=c(82015);function f(a,b){let c=b.toUpperCase(),d=parseFloat(a.replace(/[°'"″′]/g,""));if(!isNaN(d))return d*("S"===c||"W"===c?-1:1);let e=a.match(/(\d+)(?:°|d)?\s*(\d+(?:\.\d+)?)(?:['′]|m)?\s*(\d+(?:\.\d+)?)(?:["″]|s)?/i);if(e){let a=parseInt(e[1]),b=parseFloat(e[2])||0;return(a+b/60+(parseFloat(e[3])||0)/3600)*("S"===c||"W"===c?-1:1)}return null}var g=c(49888);function h({register:a,errors:b,clients:c,isClientsLoading:e}){return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),(0,d.jsx)("input",{...a("name",{required:"Project name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter project name"}),b.name&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.name.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,d.jsx)("textarea",{...a("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of the project"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client *"}),e?(0,d.jsx)("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50",children:"Loading clients..."}):(0,d.jsxs)("select",{...a("clientId",{required:"Client is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"",children:"Select a client"}),c?.map(a=>(0,d.jsx)("option",{value:a.id,children:a.name},a.id))]}),b.clientId&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.clientId.message})]})]})}var i=c(74952);function j({register:a,errors:b,gpsState:c,onGetCurrentLocation:e,onGpsInputParse:f,onGpsInputChange:g}){let{isGeocoding:h,geocodingError:j,gpsInput:k}=c;return(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"GPS Coordinates *"}),(0,d.jsxs)("button",{type:"button",onClick:e,disabled:h,className:"inline-flex items-center px-3 py-1 text-xs font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 disabled:opacity-50",children:[h?(0,d.jsx)(i.krw,{className:"w-3 h-3 mr-1 animate-spin"}):(0,d.jsx)(i.sDd,{className:"w-3 h-3 mr-1"}),"Use Current Location"]})]}),(0,d.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paste GPS Coordinates (Any Format)"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("input",{type:"text",value:k,onChange:a=>g(a.target.value),placeholder:"e.g., -34.031085, 18.463559 or 33.9221\xb0 S, 18.4231\xb0 E",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,d.jsx)("button",{type:"button",onClick:f,disabled:!k.trim()||h,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Parse"})]}),(0,d.jsx)("p",{className:"mt-1 text-xs text-gray-600",children:"Supports: decimal (-34.031, 18.463), DMS (33\xb055'19\" S, 18\xb025'23\" E), and more"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("input",{...a("location.coordinates.latitude",{required:"Latitude is required",pattern:{value:/^-?([1-8]?[0-9]\.{1}\d{1,6}$|90\.{1}0{1,6}$)/,message:"Enter valid latitude (-35 to -22 for SA)"}}),type:"number",step:"any",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Latitude (e.g., -26.195246)"}),b.location?.coordinates?.latitude&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.location.coordinates.latitude.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("input",{...a("location.coordinates.longitude",{required:"Longitude is required",pattern:{value:/^-?(([-+]?)([\d]{1,3})((\.)(\d+))?)/,message:"Enter valid longitude (16 to 33 for SA)"}}),type:"number",step:"any",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Longitude (e.g., 28.034088)"}),b.location?.coordinates?.longitude&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.location.coordinates.longitude.message})]})]}),j&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:j}),h&&(0,d.jsxs)("div",{className:"mt-2 flex items-center text-sm text-blue-600",children:[(0,d.jsx)(i.krw,{className:"w-4 h-4 mr-2 animate-spin"}),"Looking up location information..."]})]})}function k({register:a,errors:b,isGeocoding:c}){return(0,d.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Location details (auto-populated from GPS coordinates):"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City/Town"}),(0,d.jsx)("input",{...a("location.city",{required:"City/Town is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50",placeholder:"Will be auto-populated",readOnly:c}),b.location?.city&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.location.city.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Municipal District"}),(0,d.jsx)("input",{...a("location.region",{required:"Region is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50",placeholder:"Will be auto-populated",readOnly:c}),b.location?.region&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.location.region.message})]})]}),(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Province"}),(0,d.jsx)("input",{...a("location.province",{required:"Province is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50",placeholder:"Will be auto-populated",readOnly:c}),b.location?.province&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.location.province.message})]})]})}function l({register:a,errors:b}){return(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),(0,d.jsx)("input",{...a("startDate",{required:"Start date is required"}),type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),b.startDate&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.startDate.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (Months) *"}),(0,d.jsx)("input",{...a("durationMonths",{required:"Duration is required",min:{value:1,message:"Duration must be at least 1 month"},max:{value:60,message:"Duration cannot exceed 60 months"},valueAsNumber:!0}),type:"number",min:"1",max:"60",step:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 6"}),b.durationMonths&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.durationMonths.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Calculated End Date"}),(0,d.jsx)("input",{...a("endDate"),type:"date",className:"w-full px-3 py-2 border border-gray-200 rounded-md bg-gray-50 cursor-not-allowed",readOnly:!0,title:"This is automatically calculated based on start date and duration"}),(0,d.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Calculated from start date + duration"})]})]})}function m({form:a,clients:b,isClientsLoading:c}){let{register:i,formState:{errors:m}}=a,{gpsState:n,handleGetCurrentLocation:o,handleGpsInputParse:p,updateGpsInput:q}=function(a){let{watch:b,setValue:c}=a,[d,h]=(0,e.useState)({isGeocoding:!1,geocodingError:null,gpsInput:""});return b("startDate"),b("durationMonths"),b("location.coordinates.latitude"),b("location.coordinates.longitude"),{gpsState:d,handleGetCurrentLocation:async()=>{h(a=>({...a,isGeocoding:!0,geocodingError:null}));try{let a=await new Promise((a,b)=>{if(!navigator.geolocation)return void b(Error("Geolocation is not supported by this browser"));navigator.geolocation.getCurrentPosition(b=>{a({lat:b.coords.latitude,lng:b.coords.longitude})},a=>{b(Error(`Geolocation error: ${a.message}`))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})});c("location.coordinates.latitude",a.lat),c("location.coordinates.longitude",a.lng)}catch(a){h(a=>({...a,geocodingError:"Could not get current location"})),g.Rm.error("Geolocation error:",{data:a},"useBasicInfoForm")}finally{h(a=>({...a,isGeocoding:!1}))}},handleGpsInputParse:()=>{if(!d.gpsInput.trim())return;let a=function(a){if(!a||"string"!=typeof a)return null;let b=a.trim(),c=b.match(/^(-?\d+\.?\d*)\s*,\s*(-?\d+\.?\d*)$/);if(c){let a=parseFloat(c[1]),b=parseFloat(c[2]);if(!isNaN(a)&&!isNaN(b))return{lat:a,lng:b}}let d=b.match(/(\d+(?:\.\d+)?(?:°\d+(?:\.\d+)?['′]\d+(?:\.\d+)?["″]?|°)?)\s*([NSEW])\s*,?\s*(\d+(?:\.\d+)?(?:°\d+(?:\.\d+)?['′]\d+(?:\.\d+)?["″]?|°)?)\s*([NSEW])/i);if(d){let[,a,b,c,e]=d,g=f(a,b),h=f(c,e);if(null!==g&&null!==h)return{lat:g,lng:h}}let e=b.match(/^(-?\d+\.?\d*)\s+(-?\d+\.?\d*)$/);if(e){let a=parseFloat(e[1]),b=parseFloat(e[2]);if(!isNaN(a)&&!isNaN(b))return{lat:-1*Math.abs(a),lng:b}}let g=b.match(/-?\d+\.?\d*/g);if(g&&g.length>=2){let a=parseFloat(g[0]),b=parseFloat(g[1]);if(!isNaN(a)&&!isNaN(b))return{lat:a,lng:b}}return null}(d.gpsInput.trim());a?(c("location.coordinates.latitude",a.lat),c("location.coordinates.longitude",a.lng),h(a=>({...a,gpsInput:"",geocodingError:null}))):h(a=>({...a,geocodingError:'Could not parse GPS coordinates. Try formats like: "-34.031085, 18.463559" or "33.9221\xb0 S, 18.4231\xb0 E"'}))},updateGpsInput:a=>{h(b=>({...b,gpsInput:a}))}}}(a);return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(h,{register:i,errors:m,clients:b,isClientsLoading:c}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Location *"}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(j,{register:i,errors:m,gpsState:n,onGetCurrentLocation:o,onGpsInputParse:p,onGpsInputChange:q}),(0,d.jsx)(k,{register:i,errors:m,isGeocoding:n.isGeocoding})]})]}),(0,d.jsx)(l,{register:i,errors:m})]})}},71782:(a,b,c)=>{c.d(b,{b:()=>f});var d=c(8732),e=c(74952);function f({form:a,clientName:b="Unknown",projectManagerName:c="Unassigned"}){let f=a.getValues(),g=[{title:"Basic Information",items:[{label:"Project Name",value:f.name||"Not specified"},{label:"Description",value:f.description||"No description"},{label:"Client",value:b},{label:"Start Date",value:f.startDate||"Not set"},{label:"End Date",value:f.endDate||"Not set"}]},{title:"Project Details",items:[{label:"Location",value:f.location?.city?`${f.location.city}, ${f.location.province}`:"Not specified"},{label:"Budget",value:f.budget?.totalBudget?`R ${Number(f.budget.totalBudget).toLocaleString()}`:"Not set"},{label:"Priority",value:f.priority||"Medium"},{label:"Project Manager",value:c},{label:"Notes",value:f.description||"No additional notes"}]}];return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(e.rAV,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Review Project Information"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Please review all information before creating the project"})]}),(0,d.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 space-y-6",children:g.map(a=>(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-medium text-gray-900 mb-3 border-b border-gray-200 pb-2",children:a.title}),(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.items.map(a=>(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:a.label}),(0,d.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:a.value})]},a.label))})]},a.title))}),(0,d.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,d.jsxs)("div",{className:"flex",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)(e.rAV,{className:"h-5 w-5 text-blue-400"})}),(0,d.jsxs)("div",{className:"ml-3",children:[(0,d.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Ready to create project"}),(0,d.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,d.jsx)("p",{children:'Click "Create Project" to proceed. You can upload SOW documents and make additional changes after the project is created.'})})]})]})})]})}},74281:(a,b,c)=>{c.d(b,{b:()=>e});var d=c(74952);let e=[{id:"basic",title:"Basic Information",description:"Project name, client, and timeline",icon:d.BmN,component:"basic"},{id:"details",title:"Project Details",description:"Location, budget, and team assignment",icon:d.sDd,component:"details"},{id:"review",title:"Review & Create",description:"Review all information and create project",icon:d.rAV,component:"review"}]},91467:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{ProjectCreationWizard:()=>w});var e=c(8732),f=c(82015),g=c(44233),h=c(19918),i=c.n(h),j=c(56884),k=c(74952),l=c(46392),m=c(97170),n=c(56174),o=c(2934),p=c(43541),q=c(47077),r=c(15855),s=c(71782),t=c(2663),u=c(49888),v=a([j,l,m,n,o]);function w(){let a=(0,g.useRouter)(),[b,c]=(0,f.useState)(0),[d,h]=(0,f.useState)(!1),[v,w]=(0,f.useState)(),x=(0,j.useForm)({defaultValues:{priority:t.KB.MEDIUM}}),{data:y=[],isLoading:z}=(0,l.Ak)(),{data:A=[],isLoading:B}=(0,m.j$)(),C=(0,n.bL)(),D=async()=>{try{let a=x.getValues();if(!a.clientId)return void alert("Please select a client");if(!a.name)return void alert("Please enter a project name");let b=a.startDate,c=a.endDate;if(!c&&b&&a.durationMonths){let d=new Date(b);d.setMonth(d.getMonth()+a.durationMonths),c=d.toISOString().split("T")[0]}let d={name:a.name,projectName:a.name,projectCode:`PRJ-${Date.now()}`,clientId:a.clientId,description:a.description||a.notes||"",projectType:"installation",status:a.status||"planning",priority:a.priority,startDate:b,endDate:c||b,budget:a.budget?.totalBudget||0,projectManager:a.projectManagerId,location:a.location||null};console.log("Submitting project data:",d),console.log("Form data details:",{name:a.name,clientId:a.clientId,projectManagerId:a.projectManagerId,startDate:a.startDate,endDate:a.endDate,location:a.location,budget:a.budget});let e=await C.mutateAsync(d);u.Rm.info("Project created successfully:",{data:e},"ProjectCreationWizard"),w(e.id||e),h(!0)}catch(a){console.error("Project creation error:",a),u.Rm.error("Failed to create project:",{data:a},"ProjectCreationWizard"),alert(`Failed to create project: ${a instanceof Error?a.message:"Unknown error"}`)}},E=y?.find(a=>a.id===x.watch("clientId")),F=A?.find(a=>a.id===x.watch("projectManagerId"));return d?(0,e.jsx)("div",{className:"max-w-2xl mx-auto p-6",children:(0,e.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-8 text-center",children:[(0,e.jsx)("div",{className:"flex justify-center mb-4",children:(0,e.jsx)(k.rAV,{className:"h-16 w-16 text-green-500"})}),(0,e.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Project Created Successfully!"}),(0,e.jsx)("p",{className:"text-gray-600 mb-8",children:"Your project has been created. You can now import the Statement of Work (SOW) to populate project specifications."}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)(i(),{href:`/sow-management?projectId=${v}`,className:"inline-flex items-center justify-center w-full px-6 py-3 text-base font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,e.jsx)(k.nmj,{className:"h-5 w-5 mr-2"}),"Import SOW from Excel"]}),(0,e.jsxs)(i(),{href:`/projects/${v}`,className:"inline-flex items-center justify-center w-full px-6 py-3 text-base font-medium text-blue-600 bg-white border border-blue-600 rounded-md hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,e.jsx)(k.vdG,{className:"h-5 w-5 mr-2"}),"View Project Details"]}),(0,e.jsxs)("button",{onClick:()=>a.push("/projects"),className:"inline-flex items-center justify-center w-full px-6 py-3 text-base font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:["Go to Projects List",(0,e.jsx)(k.Qpb,{className:"h-5 w-5 ml-2"})]})]}),(0,e.jsx)("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:(0,e.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,e.jsx)("strong",{children:"Tip:"})," Importing SOW data will automatically create poles, drops, and fiber specifications for your project, saving you time on manual data entry."]})})]})}):(0,e.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,e.jsx)(o.l,{currentStep:b}),(0,e.jsxs)("form",{className:"bg-white shadow-lg rounded-lg p-6",children:[(()=>{switch(b){case 0:return(0,e.jsx)(q.B,{form:x,clients:y?.map(a=>({id:a.id,name:a.companyName}))||[],isClientsLoading:z});case 1:return(0,e.jsx)(r.u,{form:x,projectManagers:A,isProjectManagersLoading:B});case 2:return(0,e.jsx)(s.b,{form:x,clientName:E?.companyName||"Unknown",projectManagerName:F?.name||"Unassigned"});default:return null}})(),(0,e.jsx)(p.I,{currentStep:b,onPrevious:()=>{b>0&&c(b-1)},onNext:()=>{let a=x.getValues();if(0===b){if(!a.name)return void alert("Please enter a project name");if(!a.clientId)return void alert("Please select a client")}if(1===b&&!a.projectManagerId)return void alert("Please select a project manager");b<2&&c(b+1)},onSubmit:2===b?D:()=>{a.push("/projects")},isSubmitting:C.isPending,isLastStep:2===b})]})]})}[j,l,m,n,o]=v.then?(await v)():v,d()}catch(a){d(a)}})}};