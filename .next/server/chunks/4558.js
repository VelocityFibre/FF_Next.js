"use strict";exports.id=4558,exports.ids=[4558],exports.modules={21163:(a,b,c)=>{c.d(b,{V:()=>g});var d=c(8732),e=c(74952),f=c(44233);function g(){let a=(0,f.useRouter)(),{projectId:b}=a.query,c="string"==typeof b?b:"";return(0,d.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-6",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-2xl font-semibold text-neutral-900",children:"SOW Management"}),(0,d.jsx)("p",{className:"text-neutral-600 mt-1",children:"Manage Statements of Work and project contracts"})]}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsxs)("button",{onClick:()=>{let b=c?`/sow/import?projectId=${c}`:"/sow/import";a.push(b)},className:"px-4 py-2 bg-white border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 flex items-center gap-2",children:[(0,d.jsx)(e._OO,{className:"h-4 w-4"}),"Import SOW"]}),(0,d.jsxs)("button",{className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center gap-2",children:[(0,d.jsx)(e.iUU,{className:"h-4 w-4"}),"New SOW"]})]})]})})}},28090:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{g:()=>i});var e=c(8732),f=c(74952),g=c(77020),h=a([g]);function i({sows:a}){return(0,e.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200",children:(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"w-full",children:[(0,e.jsx)("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase",children:"SOW Number"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase",children:"Project"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase",children:"Client"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase",children:"Value"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase",children:"Duration"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase",children:"Milestones"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase",children:"Status"}),(0,e.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 uppercase",children:"Actions"})]})}),(0,e.jsx)("tbody",{className:"divide-y divide-neutral-200",children:a.map(a=>{var b;return(0,e.jsxs)("tr",{className:"hover:bg-neutral-50",children:[(0,e.jsx)("td",{className:"px-6 py-4",children:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-medium text-neutral-900",children:a.sowNumber}),(0,e.jsxs)("div",{className:"text-xs text-neutral-500",children:["v",a.version]})]})}),(0,e.jsx)("td",{className:"px-6 py-4",children:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-sm text-neutral-900",children:a.projectName}),a.importedData&&(0,e.jsxs)("div",{className:"text-xs text-neutral-500 mt-1",children:[a.importedData.poles," poles • ",a.importedData.houses," houses • ",a.importedData.spares," spares • ",a.importedData.fibre," fibre"]})]})}),(0,e.jsx)("td",{className:"px-6 py-4",children:(0,e.jsx)("div",{className:"text-sm text-neutral-900",children:a.clientName})}),(0,e.jsx)("td",{className:"px-6 py-4",children:(0,e.jsxs)("div",{className:"text-sm font-medium text-neutral-900",children:[a.currency," ",a.value.toLocaleString()]})}),(0,e.jsx)("td",{className:"px-6 py-4",children:(0,e.jsx)("div",{className:"text-sm text-neutral-600",children:(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsx)(f.VvS,{className:"h-3 w-3"}),new Date(a.startDate).toLocaleDateString()," -",new Date(a.endDate).toLocaleDateString()]})})}),(0,e.jsx)("td",{className:"px-6 py-4",children:a.milestones.length>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-sm text-neutral-900 mb-1",children:[a.milestones.filter(a=>"completed"===a.status).length,"/",a.milestones.length]}),(0,e.jsx)("div",{className:"w-20 bg-neutral-200 rounded-full h-2",children:(0,e.jsx)("div",{className:"bg-primary-600 h-2 rounded-full",style:{width:`${(b=a.milestones,0===b.length?0:b.filter(a=>"completed"===a.status).length/b.length*100)}%`}})})]}):(0,e.jsx)("span",{className:"text-sm text-neutral-400",children:"No milestones"})}),(0,e.jsx)("td",{className:"px-6 py-4",children:(0,e.jsx)("span",{className:(0,g.cn)("px-2 py-1 text-xs font-medium rounded-full border",function(a){switch(a){case"approved":case"completed":return"bg-success-100 text-success-800 border-success-200";case"active":return"bg-info-100 text-info-800 border-info-200";case"pending_approval":return"bg-warning-100 text-warning-800 border-warning-200";case"rejected":return"bg-error-100 text-error-800 border-error-200";default:return"bg-neutral-100 text-neutral-800 border-neutral-200"}}(a.status)),children:a.status.replace("_"," ")})}),(0,e.jsx)("td",{className:"px-6 py-4 text-right",children:(0,e.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,e.jsx)("button",{className:"p-1 hover:bg-neutral-100 rounded",children:(0,e.jsx)(f.kU3,{className:"h-4 w-4 text-neutral-600"})}),(0,e.jsx)("button",{className:"p-1 hover:bg-neutral-100 rounded",children:(0,e.jsx)(f.ffu,{className:"h-4 w-4 text-neutral-600"})}),(0,e.jsx)("button",{className:"p-1 hover:bg-neutral-100 rounded",children:(0,e.jsx)(f.f5X,{className:"h-4 w-4 text-neutral-600"})}),"draft"===a.status&&(0,e.jsx)("button",{className:"p-1 hover:bg-neutral-100 rounded",children:(0,e.jsx)(f.Vnp,{className:"h-4 w-4 text-primary-600"})})]})})]},a.id)})})]})})})}g=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})},43857:(a,b,c)=>{c.d(b,{z:()=>e});var d=c(82015);function e(){let[a,b]=(0,d.useState)([]),[c,e]=(0,d.useState)("all"),[f,g]=(0,d.useState)(!0),[h,i]=(0,d.useState)(null),j=async()=>{try{g(!0);let a=await fetch("/api/sow/list?type=all&pageSize=1000"),c=await a.json();if(!c.success)throw Error(c.error||"Failed to fetch SOW data");let d=c.data||[],e=new Map;d.forEach(a=>{let b=a.project_id;e.has(b)||e.set(b,{project_id:b,project_name:a.project_name||"Unknown Project",project_code:a.project_code||"",poles:[],drops:[],fibre:[]});let c=e.get(b);"pole"===a.type?c.poles.push(a):"drop"===a.type?c.drops.push(a):"fibre"===a.type&&c.fibre.push(a)});let f=Array.from(e.values()).map(a=>{let b=a.poles.length,c=a.drops.length,d=a.fibre.length,e=a.drops.filter(a=>a.address&&a.address.startsWith("LAW.ONT.DR")).length,f=a.drops.filter(a=>a.address&&("Spare"===a.address||a.address.toLowerCase().includes("spare"))).length,g=a.fibre.reduce((a,b)=>a+(parseFloat(b.distance)||0),0);return{id:a.project_id,sowNumber:`SOW-${a.project_code||a.project_id.substring(0,8)}`,projectName:a.project_name,clientName:"Lawley Municipality",status:b>0||c>0||d>0?"active":"draft",version:"1.0",value:0,currency:"ZAR",startDate:new Date().toISOString(),endDate:new Date().toISOString(),scope:[`${b} poles`,`${e} houses connected`,`${f} spare drops`,`${d} fibre segments (${(g/1e3).toFixed(2)}km)`],deliverables:["Network infrastructure data","Poles and drops mapping","Fibre route documentation"],milestones:[],approvals:[],documents:[],createdDate:new Date().toISOString(),lastModified:new Date().toISOString(),createdBy:"System Import",importedData:{poles:b,drops:c,houses:e,spares:f,fibre:d,fibreDistance:g}}});b(f),i(null)}catch(a){console.error("Error fetching SOW data:",a),i("Failed to load SOW data"),b([])}finally{g(!1)}},k="all"===c?a:a.filter(a=>a.status===c);return{sows:a,filteredSOWs:k,filter:c,setFilter:e,loading:f,error:h,refetch:j}}},54405:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>h});var e=c(8732),f=c(77020),g=a([f]);function h({filter:a,onFilterChange:b}){return(0,e.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-1",children:(0,e.jsx)("div",{className:"flex space-x-1",children:[{key:"all",label:"All SOWs"},{key:"draft",label:"Draft"},{key:"pending_approval",label:"Pending Approval"},{key:"active",label:"Active"},{key:"completed",label:"Completed"}].map(({key:c,label:d})=>(0,e.jsx)("button",{onClick:()=>b(c),className:(0,f.cn)("flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors",a===c?"bg-primary-100 text-primary-700":"text-neutral-600 hover:text-neutral-900 hover:bg-neutral-100"),children:d},c))})})}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},64558:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{SOWManagement:()=>i});var e=c(8732),f=c(66473),g=c(43857),h=a([f]);function i(){let{sows:a,filteredSOWs:b,filter:c,setFilter:d,loading:h,error:i}=(0,g.z)();return h?(0,e.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading SOW data from database..."})]})}):i?(0,e.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,e.jsxs)("div",{className:"text-center text-red-600",children:[(0,e.jsx)("p",{className:"text-xl font-semibold",children:"Error loading SOW data"}),(0,e.jsx)("p",{className:"mt-2",children:i})]})}):(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)(f.VO,{}),(0,e.jsx)(f.Pi,{sows:a}),(0,e.jsx)(f.JH,{filter:c,onFilterChange:d}),(0,e.jsx)(f.gX,{sows:b}),0===a.length&&(0,e.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,e.jsx)("p",{className:"text-lg",children:"No SOW data found"}),(0,e.jsx)("p",{className:"mt-2",children:"Import SOW data through the project import wizard to see it here"})]})]})}f=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})},66473:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{JH:()=>g.J,Pi:()=>f.P,VO:()=>e.V,gX:()=>h.g});var e=c(21163),f=c(68229),g=c(54405),h=c(28090),i=a([g,h]);[g,h]=i.then?(await i)():i,d()}catch(a){d(a)}})},68229:(a,b,c)=>{c.d(b,{P:()=>f});var d=c(8732),e=c(74952);function f({sows:a}){return(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-neutral-200 p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm text-neutral-600",children:"Total SOWs"}),(0,d.jsx)(e.iUU,{className:"h-4 w-4 text-neutral-400"})]}),(0,d.jsx)("p",{className:"text-2xl font-semibold text-neutral-900",children:a.length})]}),(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-neutral-200 p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm text-neutral-600",children:"Active"}),(0,d.jsx)(e.rAV,{className:"h-4 w-4 text-success-600"})]}),(0,d.jsx)("p",{className:"text-2xl font-semibold text-success-600",children:a.filter(a=>"active"===a.status).length})]}),(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-neutral-200 p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm text-neutral-600",children:"Pending"}),(0,d.jsx)(e.zD7,{className:"h-4 w-4 text-warning-600"})]}),(0,d.jsx)("p",{className:"text-2xl font-semibold text-warning-600",children:a.filter(a=>"pending_approval"===a.status).length})]}),(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-neutral-200 p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm text-neutral-600",children:"Total Value"}),(0,d.jsx)(e.G9t,{className:"h-4 w-4 text-primary-600"})]}),(0,d.jsxs)("p",{className:"text-2xl font-semibold text-primary-600",children:["$",a.reduce((a,b)=>a+b.value,0).toLocaleString()]})]})]})}},77020:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{cn:()=>h});var e=c(50802),f=c(75979),g=a([e,f]);function h(...a){return(0,f.twMerge)((0,e.clsx)(a))}[e,f]=g.then?(await g)():g,d()}catch(a){d(a)}})}};