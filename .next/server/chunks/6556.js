"use strict";exports.id=6556,exports.ids=[6556],exports.modules={6556:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{SOWImportPage:()=>n});var e=c(8732),f=c(44233),g=c(82015),h=c(52787),i=c(58709),j=c(74952),k=c(1849),l=c(49888),m=a([i]);function n(){let a=(0,f.useRouter)(),{projectId:b="",projectName:c="Current Project"}=a.query,d="string"==typeof b?b:"",[m,n]=(0,g.useState)(!1),[o,p]=(0,g.useState)(null),[q,r]=(0,g.useState)(null);return d?(0,e.jsx)(k.ErrorBoundary,{onError:(a,b)=>{l.Rm.error("Error in SOW Import Page (upload wizard)",{error:a,errorInfo:b},"SOWImportPage")},children:(0,e.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,e.jsx)("div",{className:"p-6",children:(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsxs)("button",{onClick:()=>{a.back()},className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[(0,e.jsx)(j.nkM,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,e.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Import SOW Data"}),(0,e.jsx)("p",{className:"text-gray-600 mt-1",children:"Upload Excel files containing project scope of work data"})]})}),m&&d&&!q&&(0,e.jsx)(h.e,{projectId:d,projectName:"string"==typeof c?c:"Current Project",onComplete:()=>{d?a.push(`/projects/${d}`):a.push("/sow")}}),q&&(0,e.jsx)("div",{className:"max-w-2xl mx-auto mt-6",children:(0,e.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"URL Validation Error"}),(0,e.jsx)("p",{className:"text-red-600",children:q}),(0,e.jsx)("button",{onClick:()=>a.push("/sow/import"),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Go Back to Safe Page"})]})})})})]})}):(0,e.jsx)(k.ErrorBoundary,{onError:(a,b)=>{l.Rm.error("Error in SOW Import Page (project selection)",{error:a,errorInfo:b},"SOWImportPage")},children:(0,e.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,e.jsxs)("div",{className:"p-6",children:[(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsxs)("button",{onClick:()=>a.push("/sow"),className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[(0,e.jsx)(j.nkM,{className:"h-4 w-4 mr-2"}),"Back to SOW List"]}),(0,e.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Import SOW Data"}),(0,e.jsx)("p",{className:"text-gray-600 mt-1",children:"Select a project to import scope of work data"})]}),(0,e.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,e.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[q&&(0,e.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,e.jsx)("div",{className:"ml-3",children:(0,e.jsx)("p",{className:"text-sm text-red-800",children:q})})]})}),(0,e.jsxs)("div",{className:"text-center mb-8",children:[(0,e.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:(0,e.jsx)(j.nmj,{className:"h-8 w-8 text-blue-600"})}),(0,e.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Select a Project"}),(0,e.jsx)("p",{className:"text-gray-600",children:"Choose the project you want to import SOW data for"})]}),o?(0,e.jsx)(()=>(0,e.jsxs)("div",{className:"text-center p-4 border border-gray-200 rounded-lg",children:[(0,e.jsx)("p",{className:"text-gray-600 mb-2",children:"Unable to load project selector."}),(0,e.jsx)("button",{onClick:()=>a.push("/sow"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Return to SOW List"})]}),{}):(0,e.jsx)(i.K,{onProjectSelect:b=>{if(!b?.id)return void l.Rm.warn("Invalid project selected",{project:b},"SOWImportPage");let c=b.name.replace(/[^\w\s-]/g,"").trim().substring(0,100);a.push(`/sow/import?projectId=${b.id}&projectName=${encodeURIComponent(c)}`)},className:"mx-auto max-w-sm"}),(0,e.jsx)("div",{className:"mt-8 text-center",children:(0,e.jsx)("p",{className:"text-sm text-gray-500",children:"You can import Excel files containing scope of work details, schedules, and other project data"})})]})})]})})})}i=(m.then?(await m)():m)[0],d()}catch(a){d(a)}})},33790:(a,b,c)=>{c.d(b,{S:()=>f});var d=c(49888);let e="/api",f={async getAllProjects(a){try{let b=`${e}/projects`,c=new URLSearchParams;a&&(a.status&&c.append("status",a.status),a.clientId&&c.append("clientId",a.clientId)),c.toString()&&(b+=`?${c.toString()}`);let d=await fetch(b);if(!d.ok)throw Error(`Failed to fetch projects: ${d.status}`);return(await d.json()).data||[]}catch(a){throw d.Rm.error("Error fetching projects:",{error:a},"projectApi"),a}},async getProjectById(a){try{let b=await fetch(`${e}/projects?id=${a}`);if(!b.ok)throw Error(`Failed to fetch project: ${b.status}`);return(await b.json()).data||null}catch(b){throw d.Rm.error("Error fetching project by ID:",{error:b,id:a},"projectApi"),b}},async getProjectsByClient(a){try{let b=await fetch(`${e}/projects?clientId=${a}`);if(!b.ok)throw Error(`Failed to fetch projects by client: ${b.status}`);return(await b.json()).data||[]}catch(b){return d.Rm.error("Error fetching projects by client:",{error:b,clientId:a},"projectApi"),[]}},async getProjectsByStatus(a){try{let b=await fetch(`${e}/projects?status=${a}`);if(!b.ok)throw Error(`Failed to fetch projects by status: ${b.status}`);return(await b.json()).data||[]}catch(b){return d.Rm.error("Error fetching projects by status:",{error:b,status:a},"projectApi"),[]}},async searchProjects(a){try{let b=await fetch(`${e}/projects?search=${encodeURIComponent(a)}`);if(!b.ok)throw Error(`Failed to search projects: ${b.status}`);return(await b.json()).data||[]}catch(b){return d.Rm.error("Error searching projects:",{error:b,searchTerm:a},"projectApi"),[]}},async getActiveProjects(){try{let a=await fetch(`${e}/projects`);if(!a.ok)throw Error(`Failed to fetch active projects: ${a.status}`);return((await a.json()).data||[]).map(a=>({...a,id:a.id,name:a.project_name||a.name,code:a.project_code||a.code,clientId:a.client_id||a.clientId,clientName:a.client_name||a.clientName,projectType:a.project_type||a.projectType,startDate:a.start_date||a.startDate,endDate:a.end_date||a.endDate,projectManager:a.project_manager||a.projectManager,description:a.description,status:a.status})).filter(a=>!["completed","archived","cancelled","on_hold"].includes(a.status?.toLowerCase()||""))}catch(a){return d.Rm.error("Error fetching active projects:",{error:a},"projectApi"),[]}},async createProject(a){try{let b=await fetch(`${e}/projects`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_code:a.code,project_name:a.name,client_id:a.clientId,description:a.description,project_type:a.projectType,status:a.status||"PLANNING",priority:a.priority||"MEDIUM",start_date:a.startDate,end_date:a.endDate,budget:a.budget,project_manager:a.projectManagerId,location:a.location})});if(!b.ok)throw Error(`Failed to create project: ${b.status}`);let c=await b.json();return c.data?.id||""}catch(b){throw d.Rm.error("Error creating project:",{error:b,data:a},"projectApi"),b}},async updateProject(a,b){try{let c=await fetch(`${e}/projects?id=${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_name:b.name,project_code:b.code,client_id:b.clientId,description:b.description,project_type:b.projectType,status:b.status,priority:b.priority,start_date:b.startDate,end_date:b.endDate,budget:b.budget,project_manager:b.projectManagerId,location:b.location})});if(!c.ok)throw Error(`Failed to update project: ${c.status}`)}catch(c){throw d.Rm.error("Error updating project:",{error:c,id:a,data:b},"projectApi"),c}},async deleteProject(a){try{let b=await fetch(`${e}/projects?id=${a}`,{method:"DELETE"});if(!b.ok)throw Error(`Failed to delete project: ${b.status}`)}catch(b){throw d.Rm.error("Error deleting project:",{error:b,id:a},"projectApi"),b}},async updateProjectStatus(a,b){try{let c=await fetch(`${e}/projects?id=${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})});if(!c.ok)throw Error(`Failed to update project status: ${c.status}`)}catch(c){throw d.Rm.error("Error updating project status:",{error:c,id:a,status:b},"projectApi"),c}},async updateProjectProgress(a,b){try{let c=await fetch(`${e}/projects?id=${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({progress:b})});if(!c.ok)throw Error(`Failed to update project progress: ${c.status}`)}catch(c){throw d.Rm.error("Error updating project progress:",{error:c,id:a,progress:b},"projectApi"),c}},async updateProjectBudget(a,b){try{let c=await fetch(`${e}/projects?id=${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({budget:b})});if(!c.ok)throw Error(`Failed to update project budget: ${c.status}`)}catch(c){throw d.Rm.error("Error updating project budget:",{error:c,id:a,budget:b},"projectApi"),c}},async assignProjectToClient(a,b){try{let c=await fetch(`${e}/projects?id=${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:b})});if(!c.ok)throw Error(`Failed to assign project to client: ${c.status}`)}catch(c){throw d.Rm.error("Error assigning project to client:",{error:c,projectId:a,clientId:b},"projectApi"),c}},async updateProjectDates(a,b,c){try{let d=await fetch(`${e}/projects?id=${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({start_date:b,end_date:c})});if(!d.ok)throw Error(`Failed to update project dates: ${d.status}`)}catch(e){throw d.Rm.error("Error updating project dates:",{error:e,id:a,startDate:b,endDate:c},"projectApi"),e}}}},52787:(a,b,c)=>{c.d(b,{e:()=>e});var d=c(8732);function e({projectName:a="Project",onComplete:b}){return(0,d.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[(0,d.jsxs)("p",{className:"text-lg",children:["Checking import status for ",a,"..."]}),(0,d.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"SOW Upload functionality is being configured."})]})}c(82015)},54659:(a,b,c)=>{c.d(b,{F:()=>e});var d=c(33790);class e{static async getAllProjects(a){return d.S.getAllProjects(a)}static async getProjectById(a){return d.S.getProjectById(a)}static async getProjectsByClient(a){return d.S.getProjectsByClient(a)}static async getProjectsByStatus(a){return d.S.getProjectsByStatus(a)}static async searchProjects(a){return d.S.searchProjects(a)}static async getActiveProjects(){return d.S.getActiveProjects()}static async getProjectsPaginated(a=10,b=0,c){let e=await d.S.getAllProjects(c);return{projects:e.slice(b,b+a),total:e.length}}}},56877:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{$:()=>i});var e=c(8732),f=c(82015),g=c(50802),h=a([g]);g=(h.then?(await h)():h)[0];let i=(0,f.forwardRef)(({className:a,variant:b="primary",size:c="md",fullWidth:d=!1,loading:f=!1,disabled:h,children:i,...j},k)=>(0,e.jsxs)("button",{ref:k,className:(0,g.clsx)("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50 focus:ring-gray-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[b],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[c],d&&"w-full",a),disabled:h||f,...j,children:[f&&(0,e.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,e.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,e.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]}));i.displayName="Button",d()}catch(a){d(a)}})},58709:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{K:()=>l});var e=c(8732),f=c(82015),g=c(74952),h=c(56877),i=c(54659),j=c(49888),k=a([h]);function l({onProjectSelect:a,className:b=""}){let[c,d]=(0,f.useState)(!1),[k,l]=(0,f.useState)(""),[m,n]=(0,f.useState)(null),o=(0,f.useRef)(null),[p,q]=(0,f.useState)([]),[r,s]=(0,f.useState)(!0),[t,u]=(0,f.useState)(null),v=async()=>{s(!0),u(null);try{let a=await i.F.getActiveProjects();q(a)}catch(a){j.Rm.error("Error loading projects:",{data:a},"SOWProjectSelector"),q([]),u("Failed to load projects. Please try again.")}finally{s(!1)}},w=p.filter(a=>!!a&&!!a.name&&!!a.code&&(a.name.toLowerCase().includes(k.toLowerCase())||a.code.toLowerCase().includes(k.toLowerCase())));return(0,e.jsxs)("div",{className:`relative ${b}`,ref:o,children:[(0,e.jsxs)(h.$,{variant:"outline",onClick:()=>d(!c),className:"min-w-[320px] justify-between",children:[(0,e.jsx)("div",{className:"flex items-center gap-2 flex-1 text-left",children:m?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.t6i,{className:"h-4 w-4 text-gray-500"}),(0,e.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,e.jsx)("div",{className:"font-medium text-gray-900 truncate",children:m.name}),(0,e.jsx)("div",{className:"text-xs text-gray-500",children:m.code})]})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.t6i,{className:"h-4 w-4 text-gray-500"}),(0,e.jsx)("span",{className:"text-gray-500",children:"Select a project"})]})}),(0,e.jsx)(g.yQN,{className:`h-4 w-4 transition-transform ${c?"rotate-180":""}`})]}),c&&(0,e.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[(0,e.jsx)("div",{className:"p-3 border-b border-gray-100",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(g.vji,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,e.jsx)("input",{type:"text",placeholder:"Search projects...",value:k,onChange:a=>l(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!0})]})}),(0,e.jsx)("div",{className:"max-h-64 overflow-y-auto",children:r?(0,e.jsx)("div",{className:"px-4 py-6 text-center text-gray-500 text-sm",children:(0,e.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(g.krw,{className:"h-4 w-4 animate-spin"}),"Loading projects..."]})}):w.length>0?(0,e.jsx)("div",{className:"py-1",children:w.map(b=>(0,e.jsx)("button",{onClick:()=>(b=>{if(!b?.id||!b?.name)return void j.Rm.warn("Invalid project data",{project:b},"SOWProjectSelector");n(b),a(b),d(!1),l("")})(b),className:`w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors ${m?.id===b.id?"bg-primary-50 text-primary-700":"text-gray-900"}`,children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(g.t6i,{className:"h-4 w-4 text-gray-500"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-medium",children:b.name}),(0,e.jsx)("div",{className:"text-sm text-gray-500",children:b.code||"No code"})]})]})},b.id))}):k?(0,e.jsxs)("div",{className:"px-4 py-6 text-center text-gray-500 text-sm",children:['No projects found matching "',k,'"']}):t?(0,e.jsxs)("div",{className:"px-4 py-6 text-center",children:[(0,e.jsx)("p",{className:"text-red-600 text-sm mb-2",children:t}),(0,e.jsx)("button",{onClick:v,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]}):(0,e.jsx)("div",{className:"px-4 py-6 text-center text-gray-500 text-sm",children:"No active projects available"})}),(0,e.jsx)("div",{className:"p-3 border-t border-gray-100 bg-gray-50",children:(0,e.jsxs)("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[(0,e.jsxs)("span",{children:[w.length," project",1!==w.length?"s":""," available"]}),(0,e.jsx)("button",{onClick:()=>d(!1),className:"text-primary-600 hover:text-primary-700",children:"Close"})]})})]})]})}h=(k.then?(await k)():k)[0],d()}catch(a){d(a)}})}};